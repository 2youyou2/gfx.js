{"version":3,"file":"gfx.dev.js","sources":["../lib/enums.js","../lib/vertex-format.js","../lib/index-buffer.js","../lib/vertex-buffer.js","../lib/program.js","../lib/texture.js","../lib/texture-2d.js","../lib/texture-cube.js","../lib/render-buffer.js","../lib/frame-buffer.js","../lib/state.js","../lib/device.js","../index.js"],"sourcesContent":["const GL_NEAREST = 9728;                // gl.NEAREST\nconst GL_LINEAR = 9729;                 // gl.LINEAR\nconst GL_NEAREST_MIPMAP_NEAREST = 9984; // gl.NEAREST_MIPMAP_NEAREST\nconst GL_LINEAR_MIPMAP_NEAREST = 9985;  // gl.LINEAR_MIPMAP_NEAREST\nconst GL_NEAREST_MIPMAP_LINEAR = 9986;  // gl.NEAREST_MIPMAP_LINEAR\nconst GL_LINEAR_MIPMAP_LINEAR = 9987;   // gl.LINEAR_MIPMAP_LINEAR\n\n// const GL_BYTE = 5120;                  // gl.BYTE\nconst GL_UNSIGNED_BYTE = 5121;            // gl.UNSIGNED_BYTE\n// const GL_SHORT = 5122;                 // gl.SHORT\nconst GL_UNSIGNED_SHORT = 5123;           // gl.UNSIGNED_SHORT\nconst GL_UNSIGNED_INT = 5125;             // gl.UNSIGNED_INT\nconst GL_FLOAT = 5126;                    // gl.FLOAT\nconst GL_UNSIGNED_SHORT_5_6_5 = 33635;    // gl.UNSIGNED_SHORT_5_6_5\nconst GL_UNSIGNED_SHORT_4_4_4_4 = 32819;  // gl.UNSIGNED_SHORT_4_4_4_4\nconst GL_UNSIGNED_SHORT_5_5_5_1 = 32820;  // gl.UNSIGNED_SHORT_5_5_5_1\nconst GL_HALF_FLOAT_OES = 36193;          // gl.HALF_FLOAT_OES\n\nconst GL_DEPTH_COMPONENT = 6402; // gl.DEPTH_COMPONENT\n\nconst GL_ALPHA = 6406;            // gl.ALPHA\nconst GL_RGB = 6407;              // gl.RGB\nconst GL_RGBA = 6408;             // gl.RGBA\nconst GL_LUMINANCE = 6409;        // gl.LUMINANCE\nconst GL_LUMINANCE_ALPHA = 6410;  // gl.LUMINANCE_ALPHA\n\nconst GL_COMPRESSED_RGB_S3TC_DXT1_EXT = 0x83F0;   // ext.COMPRESSED_RGB_S3TC_DXT1_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT1_EXT = 0x83F1;  // ext.COMPRESSED_RGBA_S3TC_DXT1_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT3_EXT = 0x83F2;  // ext.COMPRESSED_RGBA_S3TC_DXT3_EXT\nconst GL_COMPRESSED_RGBA_S3TC_DXT5_EXT = 0x83F3;  // ext.COMPRESSED_RGBA_S3TC_DXT5_EXT\n\nconst GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 0x8C00;  // ext.COMPRESSED_RGB_PVRTC_4BPPV1_IMG\nconst GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 0x8C01;  // ext.COMPRESSED_RGB_PVRTC_2BPPV1_IMG\nconst GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 0x8C02; // ext.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\nconst GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 0x8C03; // ext.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\n\nconst GL_COMPRESSED_RGB_ETC1_WEBGL = 0x8D64; // ext.COMPRESSED_RGB_ETC1_WEBGL\n\nconst _filterGL = [\n  [ GL_NEAREST,  GL_NEAREST_MIPMAP_NEAREST, GL_NEAREST_MIPMAP_LINEAR ],\n  [ GL_LINEAR,  GL_LINEAR_MIPMAP_NEAREST, GL_LINEAR_MIPMAP_LINEAR ],\n];\n\nconst _textureFmtGL = [\n  // TEXTURE_FMT_RGB_DXT1: 0\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_S3TC_DXT1_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT1: 1\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT1_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT3: 2\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT3_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_DXT5: 3\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_S3TC_DXT5_EXT, pixelType: null },\n\n  // TEXTURE_FMT_RGB_ETC1: 4\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_ETC1_WEBGL, pixelType: null },\n\n  // TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7\n  { format: GL_RGB, internalFormat: GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8\n  { format: GL_RGBA, internalFormat: GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG, pixelType: null },\n\n  // TEXTURE_FMT_A8: 9\n  { format: GL_ALPHA, internalFormat: GL_ALPHA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_L8: 10\n  { format: GL_LUMINANCE, internalFormat: GL_LUMINANCE, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_L8_A8: 11\n  { format: GL_LUMINANCE_ALPHA, internalFormat: GL_LUMINANCE_ALPHA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_R5_G6_B5: 12\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_UNSIGNED_SHORT_5_6_5 },\n\n  // TEXTURE_FMT_R5_G5_B5_A1: 13\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_SHORT_5_5_5_1 },\n\n  // TEXTURE_FMT_R4_G4_B4_A4: 14\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_SHORT_4_4_4_4 },\n\n  // TEXTURE_FMT_RGB8: 15\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_RGBA8: 16\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_UNSIGNED_BYTE },\n\n  // TEXTURE_FMT_RGB16F: 17\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_HALF_FLOAT_OES },\n\n  // TEXTURE_FMT_RGBA16F: 18\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_HALF_FLOAT_OES },\n\n  // TEXTURE_FMT_RGB32F: 19\n  { format: GL_RGB, internalFormat: GL_RGB, pixelType: GL_FLOAT },\n\n  // TEXTURE_FMT_RGBA32F: 20\n  { format: GL_RGBA, internalFormat: GL_RGBA, pixelType: GL_FLOAT },\n\n  // TEXTURE_FMT_R32F: 21\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_111110F: 22\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_SRGB: 23\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_SRGBA: 24\n  { format: null, internalFormat: null, pixelType: null },\n\n  // TEXTURE_FMT_D16: 25\n  { format: GL_DEPTH_COMPONENT, internalFormat: GL_DEPTH_COMPONENT, pixelType: GL_UNSIGNED_SHORT },\n\n  // TEXTURE_FMT_D24: 26\n  { format: GL_DEPTH_COMPONENT, internalFormat: GL_DEPTH_COMPONENT, pixelType: GL_UNSIGNED_INT },\n\n  // TEXTURE_FMT_D24S8: 27\n  { format: null, internalFormat: null, pixelType: null },\n];\n\n/**\n * enums\n */\nexport const enums = {\n  // buffer usage\n  USAGE_STATIC: 35044,  // gl.STATIC_DRAW\n  USAGE_DYNAMIC: 35048, // gl.DYNAMIC_DRAW\n  USAGE_STREAM: 35040,  // gl.STREAM_DRAW\n\n  // index buffer format\n  INDEX_FMT_UINT8: 5121,  // gl.UNSIGNED_BYTE\n  INDEX_FMT_UINT16: 5123, // gl.UNSIGNED_SHORT\n  INDEX_FMT_UINT32: 5125, // gl.UNSIGNED_INT (OES_element_index_uint)\n\n  // vertex attribute semantic\n  ATTR_POSITION: 'a_position',\n  ATTR_NORMAL: 'a_normal',\n  ATTR_TANGENT: 'a_tangent',\n  ATTR_BITANGENT: 'a_bitangent',\n  ATTR_WEIGHT: 'a_weight',\n  ATTR_INDICES: 'a_indices',\n  ATTR_COLOR: 'a_color',\n  ATTR_COLOR0: 'a_color0',\n  ATTR_COLOR1: 'a_color1',\n  ATTR_UV: 'a_uv',\n  ATTR_UV0: 'a_uv0',\n  ATTR_UV1: 'a_uv1',\n  ATTR_UV2: 'a_uv2',\n  ATTR_UV3: 'a_uv3',\n  ATTR_UV4: 'a_uv4',\n  ATTR_UV5: 'a_uv5',\n  ATTR_UV6: 'a_uv6',\n  ATTR_UV7: 'a_uv7',\n\n  // vertex attribute type\n  ATTR_TYPE_INT8: 5120,    // gl.BYTE\n  ATTR_TYPE_UINT8: 5121,   // gl.UNSIGNED_BYTE\n  ATTR_TYPE_INT16: 5122,   // gl.SHORT\n  ATTR_TYPE_UINT16: 5123,  // gl.UNSIGNED_SHORT\n  ATTR_TYPE_INT32: 5124,   // gl.INT\n  ATTR_TYPE_UINT32: 5125,  // gl.UNSIGNED_INT\n  ATTR_TYPE_FLOAT32: 5126, // gl.FLOAT\n\n  // texture filter\n  FILTER_NEAREST: 0,\n  FILTER_LINEAR: 1,\n\n  // texture wrap mode\n  WRAP_REPEAT: 10497, // gl.REPEAT\n  WRAP_CLAMP: 33071,  // gl.CLAMP_TO_EDGE\n  WRAP_MIRROR: 33648, // gl.MIRRORED_REPEAT\n\n  // texture format\n  // compress formats\n  TEXTURE_FMT_RGB_DXT1: 0,\n  TEXTURE_FMT_RGBA_DXT1: 1,\n  TEXTURE_FMT_RGBA_DXT3: 2,\n  TEXTURE_FMT_RGBA_DXT5: 3,\n  TEXTURE_FMT_RGB_ETC1: 4,\n  TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5,\n  TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6,\n  TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7,\n  TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8,\n\n  // normal formats\n  TEXTURE_FMT_A8: 9,\n  TEXTURE_FMT_L8: 10,\n  TEXTURE_FMT_L8_A8: 11,\n  TEXTURE_FMT_R5_G6_B5: 12,\n  TEXTURE_FMT_R5_G5_B5_A1: 13,\n  TEXTURE_FMT_R4_G4_B4_A4: 14,\n  TEXTURE_FMT_RGB8: 15,\n  TEXTURE_FMT_RGBA8: 16,\n  TEXTURE_FMT_RGB16F: 17,\n  TEXTURE_FMT_RGBA16F: 18,\n  TEXTURE_FMT_RGB32F: 19,\n  TEXTURE_FMT_RGBA32F: 20,\n  TEXTURE_FMT_R32F: 21,\n  TEXTURE_FMT_111110F: 22,\n  TEXTURE_FMT_SRGB: 23,\n  TEXTURE_FMT_SRGBA: 24,\n\n  // depth formats\n  TEXTURE_FMT_D16: 25,\n  TEXTURE_FMT_D32: 26,\n  TEXTURE_FMT_D24S8: 27,\n\n  // depth and stencil function\n  DS_FUNC_NEVER: 512,    // gl.NEVER\n  DS_FUNC_LESS: 513,     // gl.LESS\n  DS_FUNC_EQUAL: 514,    // gl.EQUAL\n  DS_FUNC_LEQUAL: 515,   // gl.LEQUAL\n  DS_FUNC_GREATER: 516,  // gl.GREATER\n  DS_FUNC_NOTEQUAL: 517, // gl.NOTEQUAL\n  DS_FUNC_GEQUAL: 518,   // gl.GEQUAL\n  DS_FUNC_ALWAYS: 519,   // gl.ALWAYS\n\n  // render-buffer format\n  RB_FMT_RGBA4: 32854,    // gl.RGBA4\n  RB_FMT_RGB5_A1: 32855,  // gl.RGB5_A1\n  RB_FMT_RGB565: 36194,   // gl.RGB565\n  RB_FMT_D16: 33189,      // gl.DEPTH_COMPONENT16\n  RB_FMT_S8: 36168,       // gl.STENCIL_INDEX8\n  RB_FMT_D24S8: 34041,    // gl.DEPTH_STENCIL\n\n  // blend-equation\n  BLEND_FUNC_ADD: 32774,              // gl.FUNC_ADD\n  BLEND_FUNC_SUBTRACT: 32778,         // gl.FUNC_SUBTRACT\n  BLEND_FUNC_REVERSE_SUBTRACT: 32779, // gl.FUNC_REVERSE_SUBTRACT\n\n  // blend\n  BLEND_ZERO: 0,                          // gl.ZERO\n  BLEND_ONE: 1,                           // gl.ONE\n  BLEND_SRC_COLOR: 768,                   // gl.SRC_COLOR\n  BLEND_ONE_MINUS_SRC_COLOR: 769,         // gl.ONE_MINUS_SRC_COLOR\n  BLEND_DST_COLOR: 774,                   // gl.DST_COLOR\n  BLEND_ONE_MINUS_DST_COLOR: 775,         // gl.ONE_MINUS_DST_COLOR\n  BLEND_SRC_ALPHA: 770,                   // gl.SRC_ALPHA\n  BLEND_ONE_MINUS_SRC_ALPHA: 771,         // gl.ONE_MINUS_SRC_ALPHA\n  BLEND_DST_ALPHA: 772,                   // gl.DST_ALPHA\n  BLEND_ONE_MINUS_DST_ALPHA: 773,         // gl.ONE_MINUS_DST_ALPHA\n  BLEND_CONSTANT_COLOR: 32769,            // gl.CONSTANT_COLOR\n  BLEND_ONE_MINUS_CONSTANT_COLOR: 32770,  // gl.ONE_MINUS_CONSTANT_COLOR\n  BLEND_CONSTANT_ALPHA: 32771,            // gl.CONSTANT_ALPHA\n  BLEND_ONE_MINUS_CONSTANT_ALPHA: 32772,  // gl.ONE_MINUS_CONSTANT_ALPHA\n  BLEND_SRC_ALPHA_SATURATE: 776,          // gl.SRC_ALPHA_SATURATE\n\n  // stencil operation\n  STENCIL_OP_KEEP: 7680,          // gl.KEEP\n  STENCIL_OP_ZERO: 0,             // gl.ZERO\n  STENCIL_OP_REPLACE: 7681,       // gl.REPLACE\n  STENCIL_OP_INCR: 7682,          // gl.INCR\n  STENCIL_OP_INCR_WRAP: 34055,    // gl.INCR_WRAP\n  STENCIL_OP_DECR: 7683,          // gl.DECR\n  STENCIL_OP_DECR_WRAP: 34056,    // gl.DECR_WRAP\n  STENCIL_OP_INVERT: 5386,        // gl.INVERT\n\n  // cull\n  CULL_NONE: 0,\n  CULL_FRONT: 1028,\n  CULL_BACK: 1029,\n  CULL_FRONT_AND_BACK: 1032,\n\n  // primitive type\n  PT_POINTS: 0,         // gl.POINTS\n  PT_LINES: 1,          // gl.LINES\n  PT_LINE_LOOP: 2,      // gl.LINE_LOOP\n  PT_LINE_STRIP: 3,     // gl.LINE_STRIP\n  PT_TRIANGLES: 4,      // gl.TRIANGLES\n  PT_TRIANGLE_STRIP: 5, // gl.TRIANGLE_STRIP\n  PT_TRIANGLE_FAN: 6,   // gl.TRIANGLE_FAN\n};\n\n/**\n * @method attrTypeBytes\n * @param {ATTR_TYPE_*} attrType\n */\nexport function attrTypeBytes(attrType) {\n  if (attrType === enums.ATTR_TYPE_INT8) {\n    return 1;\n  } else if (attrType === enums.ATTR_TYPE_UINT8) {\n    return 1;\n  } else if (attrType === enums.ATTR_TYPE_INT16) {\n    return 2;\n  } else if (attrType === enums.ATTR_TYPE_UINT16) {\n    return 2;\n  } else if (attrType === enums.ATTR_TYPE_INT32) {\n    return 4;\n  } else if (attrType === enums.ATTR_TYPE_UINT32) {\n    return 4;\n  } else if (attrType === enums.ATTR_TYPE_FLOAT32) {\n    return 4;\n  }\n\n  console.warn(`Unknown ATTR_TYPE: ${attrType}`);\n  return 0;\n}\n\n/**\n * @method glFilter\n * @param {WebGLContext} gl\n * @param {FILTER_*} filter\n * @param {FILTER_*} mipFilter\n */\nexport function glFilter(gl, filter, mipFilter = -1) {\n  let result = _filterGL[filter][mipFilter+1];\n  if (result === undefined) {\n    console.warn(`Unknown FILTER: ${filter}`);\n    return mipFilter === -1 ? gl.LINEAR : gl.LINEAR_MIPMAP_LINEAR;\n  }\n\n  return result;\n}\n\n/**\n * @method glTextureFmt\n * @param {TEXTURE_FMT_*} fmt\n */\nexport function glTextureFmt(fmt) {\n  let result = _textureFmtGL[fmt];\n  if (result === undefined) {\n    console.warn(`Unknown TEXTURE_FMT: ${fmt}`);\n    return _textureFmtGL[enums.TEXTURE_FMT_RGBA8];\n  }\n\n  return result;\n}","import { attrTypeBytes } from './enums';\n\n// ====================\n// exports\n// ====================\n\nexport default class VertexFormat {\n  /**\n   * @constructor\n   * @param {Array} infos\n   *\n   * @example\n   * let vertexFmt = new VertexFormat([\n   *   { name: gfx.ATTR_POSITION, type: gfx.ATTR_TYPE_FLOAT32, num: 3 },\n   *   { name: gfx.ATTR_UV0, type: gfx.ATTR_TYPE_FLOAT32, num: 2 },\n   *   { name: gfx.ATTR_COLOR, type: gfx.ATTR_TYPE_FLOAT32, num: 4, normalize: true },\n   * ])\n   */\n  constructor(infos) {\n    this._attr2el = {};\n    this._elements = [];\n    this._bytes = 0;\n\n    let offset = 0;\n    for (let i = 0, len = infos.length; i < len; ++i) {\n      let info = infos[i];\n      let el = {\n        name: info.name,\n        offset: offset,\n        stride: 0,\n        stream: -1,\n        type: info.type,\n        num: info.num,\n        normalize: (info.normalize === undefined) ? false : info.normalize,\n        bytes: info.num * attrTypeBytes(info.type),\n      };\n\n      this._attr2el[el.name] = el;\n      this._elements.push(el);\n\n      this._bytes += el.bytes;\n      offset += el.bytes;\n    }\n\n    for (let i = 0, len = this._elements.length; i < len; ++i) {\n      let el = this._elements[i];\n      el.stride = this._bytes;\n    }\n  }\n\n  /**\n   * @method element\n   * @param {string} attrName\n   */\n  element(attrName) {\n    return this._attr2el[attrName];\n  }\n}","import { enums } from './enums';\n\nexport default class IndexBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {INDEX_FMT_*} format\n   * @param {USAGE_*} usage\n   * @param {ArrayBuffer} data\n   * @param {Number} numIndices\n   * @param {Boolean} persist\n   */\n  constructor(device, format, usage, data, numIndices, persist) {\n    this._device = device;\n    this._format = format;\n    this._usage = usage;\n    this._persist = persist;\n    this._numIndices = numIndices;\n\n    // calculate bytes\n    let bytes = 0;\n    if (format === enums.INDEX_FMT_UINT8) {\n      bytes = numIndices;\n    } else if (format === enums.INDEX_FMT_UINT16) {\n      bytes = 2 * numIndices;\n    } else if (format === enums.INDEX_FMT_UINT32) {\n      bytes = 4 * numIndices;\n    }\n    this._bytes = bytes;\n\n    // update\n    this._glID = device._gl.createBuffer();\n    this._data = null;\n    this.update(0, data);\n\n    // stats\n    device._stats.ib += bytes;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === -1) {\n      console.error('The buffer already destroyed');\n      return;\n    }\n\n    let gl = this.device.gl;\n    gl.deleteBuffer(this._glID);\n    this.device._stats.ib -= this.bytes;\n\n    this._glID = -1;\n  }\n\n  /**\n   * @method update\n   * @param {Number} offset\n   * @param {ArrayBuffer} data\n   */\n  update(offset, data) {\n    if (this._glID === -1) {\n      console.error('The buffer is destroyed');\n      return;\n    }\n\n    if (data && data.byteLength + offset > this._bytes) {\n      console.error('Failed to update data, bytes exceed.');\n      return;\n    }\n\n    let gl = this._device._gl;\n    let glUsage = this._usage;\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._glID);\n    if (!data) {\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._bytes, glUsage);\n    } else {\n      if (offset) {\n        gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, data, glUsage);\n      } else {\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, data, glUsage);\n      }\n    }\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n    // store the data\n    if (this._persist) {\n      if (this._data) {\n        this._data.set(data, offset);\n      } else {\n        this._data = data;\n      }\n    }\n  }\n\n  get count () {\n    return this._numIndices;\n  }\n}","export default class VertexBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {VertexFormat} format\n   * @param {USAGE_*} usage\n   * @param {ArrayBuffer} data\n   * @param {Number} numVertices\n   * @param {Boolean} persist\n   */\n  constructor(device, format, usage, data, numVertices, persist) {\n    this._device = device;\n    this._format = format;\n    this._usage = usage;\n    this._persist = persist;\n    this._numVertices = numVertices;\n\n    // calculate bytes\n    this._bytes = this._format._bytes * numVertices;\n\n    // update\n    this._glID = device._gl.createBuffer();\n    this._data = null;\n    this.update(0, data);\n\n    // stats\n    device._stats.vb += this._bytes;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === -1) {\n      console.error('The buffer already destroyed');\n      return;\n    }\n\n    let gl = this.device.gl;\n    gl.deleteBuffer(this._glID);\n    this.device._stats.vb -= this.bytes;\n\n    this._glID = -1;\n  }\n\n  /**\n   * @method update\n   * @param {Number} offset\n   * @param {ArrayBuffer} data\n   */\n  update(offset, data) {\n    if (this._glID === -1) {\n      console.error('The buffer is destroyed');\n      return;\n    }\n\n    if (data && data.byteLength + offset > this._bytes) {\n      console.error('Failed to update data, bytes exceed.');\n      return;\n    }\n\n    let gl = this._device._gl;\n    let glUsage = this._usage;\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._glID);\n    if (!data) {\n      gl.bufferData(gl.ARRAY_BUFFER, this._bytes, glUsage);\n    } else {\n      if (offset) {\n        gl.bufferSubData(gl.ARRAY_BUFFER, data, glUsage);\n      } else {\n        gl.bufferData(gl.ARRAY_BUFFER, data, glUsage);\n      }\n    }\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n    // store the data\n    if (this._persist) {\n      if (this._data) {\n        this._data.set(data, offset);\n      } else {\n        this._data = data;\n      }\n    }\n  }\n\n  get count () {\n    return this._numVertices;\n  }\n}","let _genID = 0;\n\nfunction _parseError(out, type, errorLog) {\n  errorLog.split('\\n').forEach(msg => {\n    if (msg.length < 5) {\n      return;\n    }\n\n    let parts = /^ERROR\\:\\s+(\\d+)\\:(\\d+)\\:\\s*(.*)$/.exec(msg);\n    if (parts) {\n      out.push({\n        type: type,\n        fileID: parts[1] | 0,\n        line: parts[2] | 0,\n        message: parts[3].trim()\n      });\n    } else if (msg.length > 0) {\n      out.push({\n        type: type,\n        fileID: -1,\n        line: 0,\n        message: msg\n      });\n    }\n  });\n}\n\nexport default class Program {\n  /**\n   * @param {ef.GraphicsDevice} device - graphic device\n   * @param {object} options - shader definition\n   * @param {string} options.vert - vertex shader source code\n   * @param {string} options.frag - fragment shader shader source code\n   * @example\n   * let prog = new Program(device, {\n   *   vert: `\n   *     attribute vec3 a_position;\n   *     void main() {\n   *       gl_Position = vec4( a_position, 1.0 );\n   *     }\n   *   `,\n   *   frag: `\n   *     precision mediump float;\n   *     void main() {\n   *       gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 );\n   *     }\n   *   `\n   * });\n   */\n  constructor(device, options) {\n    this._device = device;\n\n    // stores gl information: { location, type }\n    this._attributes = [];\n    this._uniforms = [];\n    this._samplers = [];\n    this._errors = [];\n    this._linked = false;\n    this._vertSource = options.vert;\n    this._fragSource = options.frag;\n    this._glID = null;\n    this._id = _genID++;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  link() {\n    if (this._linked) {\n      return;\n    }\n\n    let gl = this._device._gl;\n\n    let vertShader = _createShader(gl, gl.VERTEX_SHADER, this._vertSource);\n    let fragShader = _createShader(gl, gl.FRAGMENT_SHADER, this._fragSource);\n\n    let program = gl.createProgram();\n    gl.attachShader(program, vertShader);\n    gl.attachShader(program, fragShader);\n    gl.linkProgram(program);\n\n    let failed = false;\n    let errors = this._errors;\n\n    if (!gl.getShaderParameter(vertShader, gl.COMPILE_STATUS)) {\n      _parseError(errors, 'vs', gl.getShaderInfoLog(vertShader));\n      failed = true;\n    }\n\n    if (!gl.getShaderParameter(fragShader, gl.COMPILE_STATUS)) {\n      _parseError(errors, 'fs', gl.getShaderInfoLog(fragShader));\n      failed = true;\n    }\n\n    gl.deleteShader(vertShader);\n    gl.deleteShader(fragShader);\n\n    if (failed) {\n      errors.forEach(err => {\n        console.error(`Failed to compile ${err.type} ${err.fileID} (ln ${err.line}): ${err.message}`);\n      });\n      return;\n    }\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      console.error(`Failed to link shader program: ${gl.getProgramInfoLog(program)}`);\n      failed = true;\n    }\n\n    if (failed) {\n      return;\n    }\n\n    this._glID = program;\n\n    // parse attribute\n    let numAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    for (let i = 0; i < numAttributes; ++i) {\n      let info = gl.getActiveAttrib(program, i);\n      let location = gl.getAttribLocation(program, info.name);\n\n      this._attributes.push({\n        name: info.name,\n        location: location,\n        type: info.type,\n      });\n    }\n\n    // parse uniform\n    let numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (let i = 0; i < numUniforms; ++i) {\n      let info = gl.getActiveUniform(program, i);\n      let name = info.name;\n      let location = gl.getUniformLocation(program, name);\n      let isArray = name.substr(name.length - 3) === '[0]';\n      if (isArray) {\n        name = name.substr(0, name.length - 3);\n      }\n\n      this._uniforms.push({\n        name: name,\n        location: location,\n        type: info.type,\n        size: isArray ? info.size : undefined, // used when uniform is an array\n      });\n    }\n\n    this._linked = true;\n  }\n\n  destroy() {\n    let gl = this._device._gl;\n    gl.deleteProgram(this._glID);\n\n    this._linked = false;\n    this._glID = null;\n    this._attributes = [];\n    this._uniforms = [];\n    this._samplers = [];\n  }\n}\n\n// ====================\n// internal\n// ====================\n\nfunction _createShader(gl, type, src) {\n  let shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n\n  return shader;\n}","import { enums } from './enums';\n\nexport default class Texture {\n  /**\n   * @constructor\n   */\n  constructor(device) {\n    this._device = device;\n\n    this._width = 4;\n    this._height = 4;\n    this._hasMipmap = false;\n    this._compressed = false;\n\n    this._anisotropy = 1;\n    this._minFilter = enums.FILTER_LINEAR;\n    this._magFilter = enums.FILTER_LINEAR;\n    this._mipFilter = enums.FILTER_LINEAR;\n    this._wrapS = enums.WRAP_REPEAT;\n    this._wrapT = enums.WRAP_REPEAT;\n    // wrapR available in webgl2\n    // this._wrapR = enums.WRAP_REPEAT;\n    this._format = enums.TEXTURE_FMT_RGBA8;\n\n    this._target = -1;\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === -1) {\n      console.error('The texture already destroyed');\n      return;\n    }\n\n    let gl = this.device.gl;\n    gl.deleteTexture(this._glID);\n\n    this.device._stats.tex -= this.bytes;\n    this._glID = -1;\n  }\n}","import Texture from './texture';\nimport { enums, glFilter, glTextureFmt } from './enums';\n\nfunction _isPow2(v) {\n  return !(v & (v - 1)) && (!!v);\n}\n\nexport default class Texture2D extends Texture {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.mipmap\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  constructor(device, options) {\n    super(device);\n    this._target = this._device._gl.TEXTURE_2D;\n\n    this.update(options);\n  }\n\n  /**\n   * @method update\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.mipmap\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  update(options) {\n    let gl = this._device._gl;\n    let genMipmap = this._hasMipmap;\n\n    if (options) {\n      if (options.width !== undefined) {\n        this._width = options.width;\n      }\n      if (options.height !== undefined) {\n        this._height = options.height;\n      }\n      if (options.anisotropy !== undefined) {\n        this._anisotropy = options.anisotropy;\n      }\n      if (options.minFilter !== undefined) {\n        this._minFilter = options.minFilter;\n      }\n      if (options.magFilter !== undefined) {\n        this._magFilter = options.magFilter;\n      }\n      if (options.mipFilter !== undefined) {\n        this._mipFilter = options.mipFilter;\n      }\n      if (options.wrapS !== undefined) {\n        this._wrapS = options.wrapS;\n      }\n      if (options.wrapT !== undefined) {\n        this._wrapT = options.wrapT;\n      }\n      if (options.format !== undefined) {\n        this._format = options.format;\n        this._compressed = (\n          this._format >= enums.TEXTURE_FMT_RGB_DXT1 &&\n          this._format <= enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1\n        );\n      }\n\n      // check if generate mipmap\n      if (options.mipmap !== undefined) {\n        this._hasMipmap = options.mipmap;\n        genMipmap = options.mipmap;\n      }\n\n      if (options.images !== undefined) {\n        if (options.images.length > 1) {\n          genMipmap = false;\n        }\n      }\n    }\n\n    this._glID = gl.createTexture();\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    // always alloc texture in GPU when we create it.\n    let images = options.images || [null];\n    this._setMipmap(images, options.flipY, options.premultiplyAlpha);\n    this._setTexInfo();\n\n    if (genMipmap) {\n      gl.hint(gl.GENERATE_MIPMAP_HINT, gl.NICEST);\n      gl.generateMipmap(gl.TEXTURE_2D);\n    }\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateSubImage\n   * @param {Object} options\n   * @param {Number} options.x\n   * @param {Number} options.y\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateSubImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    this._setSubImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateImage\n   * @param {Object} options\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._glID);\n    this._setImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  _setSubImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let img = options.image;\n\n    if (\n      img instanceof HTMLCanvasElement ||\n      img instanceof HTMLImageElement ||\n      img instanceof HTMLVideoElement\n    ) {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      gl.texSubImage2D(gl.TEXTURE_2D, options.level, options.x, options.y, glFmt.format, glFmt.pixelType, img);\n    } else {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      if (this._compressed) {\n        gl.compressedTexSubImage2D(gl.TEXTURE_2D,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          img\n        );\n      } else {\n        gl.texSubImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let img = options.image;\n\n    if (\n      img instanceof HTMLCanvasElement ||\n      img instanceof HTMLImageElement ||\n      img instanceof HTMLVideoElement\n    ) {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      gl.texImage2D(\n        gl.TEXTURE_2D,\n        options.level,\n        glFmt.internalFormat,\n        glFmt.format,\n        glFmt.pixelType,\n        img\n      );\n    } else {\n      if (flipY === undefined) {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n      }\n\n      if (premultiplyAlpha === undefined) {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      } else {\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n      }\n\n      if (this._compressed) {\n        gl.compressedTexImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          img\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setMipmap(images, flipY, premultiplyAlpha) {\n    let glFmt = glTextureFmt(this._format);\n    let options = {\n      width: this._width,\n      height: this._height,\n      flipY: flipY,\n      premultiplyAlpha: premultiplyAlpha,\n      level: 0,\n      image: null\n    };\n\n    for (let i = 0; i < images.length; ++i) {\n      options.level = i;\n      options.width = this._width >> i;\n      options.height = this._height >> i;\n      options.image = images[i];\n      this._setImage(glFmt, options);\n    }\n  }\n\n  _setTexInfo() {\n    let gl = this._device._gl;\n    let pot = _isPow2(this._width) && _isPow2(this._height);\n\n    // WebGL1 doesn't support all wrap modes with NPOT textures\n    if (!pot && (this._wrapS !== enums.WRAP_CLAMP || this._wrapT !== enums.WRAP_CLAMP)) {\n      console.warn('WebGL1 doesn\\'t support all wrap modes with NPOT textures');\n      this._wrapS = enums.WRAP_CLAMP;\n      this._wrapT = enums.WRAP_CLAMP;\n    }\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, glFilter(gl, this._minFilter, this._hasMipmap ? this._mipFilter : -1));\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, glFilter(gl, this._magFilter, -1));\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this._wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this._wrapT);\n\n    let ext = this._device.ext('EXT_texture_filter_anisotropic');\n    if (ext) {\n      gl.texParameteri(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);\n    }\n  }\n}","import Texture from './texture';\nimport { enums, glFilter, glTextureFmt } from './enums';\n\nexport default class TextureCube extends Texture {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.mipmap\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {WRAP_*} options.wrapR\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  constructor(device, options) {\n    super(device);\n    this._target = this._device._gl.TEXTURE_CUBE_MAP;\n\n    this.update(options);\n  }\n\n  /**\n   * @method update\n   * @param {Object} options\n   * @param {Array} options.images\n   * @param {Boolean} options.mipmap\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {TEXTURE_FMT_*} options.format\n   * @param {Number} options.anisotropy\n   * @param {FILTER_*} options.minFilter\n   * @param {FILTER_*} options.magFilter\n   * @param {FILTER_*} options.mipFilter\n   * @param {WRAP_*} options.wrapS\n   * @param {WRAP_*} options.wrapT\n   * @param {WRAP_*} options.wrapR\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  update(options) {\n    let gl = this._device._gl;\n    let genMipmap = this._hasMipmap;\n\n    if (options) {\n      if (options.width !== undefined) {\n        this._width = options.width;\n      }\n      if (options.height !== undefined) {\n        this._height = options.height;\n      }\n      if (options.anisotropy !== undefined) {\n        this._anisotropy = options.anisotropy;\n      }\n      if (options.minFilter !== undefined) {\n        this._minFilter = options.minFilter;\n      }\n      if (options.magFilter !== undefined) {\n        this._magFilter = options.magFilter;\n      }\n      if (options.mipFilter !== undefined) {\n        this._mipFilter = options.mipFilter;\n      }\n      if (options.wrapS !== undefined) {\n        this._wrapS = options.wrapS;\n      }\n      if (options.wrapT !== undefined) {\n        this._wrapT = options.wrapT;\n      }\n      // wrapR available in webgl2\n      // if (options.wrapR !== undefined) {\n      //   this._wrapR = options.wrapR;\n      // }\n      if (options.format !== undefined) {\n        this._format = options.format;\n        this._compressed = (\n          this._format >= enums.TEXTURE_FMT_RGB_DXT1 &&\n          this._format <= enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1\n        );\n      }\n\n      // check if generate mipmap\n      if (options.mipmap !== undefined) {\n        this._hasMipmap = options.mipmap;\n        genMipmap = options.mipmap;\n      }\n\n      if (options.images !== undefined) {\n        if (options.images.length > 1) {\n          genMipmap = false;\n        }\n      }\n    }\n\n    this._glID = gl.createTexture();\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n      if (options.images !== undefined) {\n        this._setMipmap(options.images, options.flipY, options.premultiplyAlpha);\n      }\n\n      this._setTexInfo();\n\n      if (genMipmap) {\n        gl.hint(gl.GENERATE_MIPMAP_HINT, gl.NICEST);\n        gl.generateMipmap(gl.TEXTURE_CUBE_MAP);\n      }\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateSubImage\n   * @param {Object} options\n   * @param {Number} options.x\n   * @param {Number} options.y\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {Number} options.faceIndex\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateSubImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n    this._setSubImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  /**\n   * @method updateImage\n   * @param {Object} options\n   * @param {Number} options.width\n   * @param {Number} options.height\n   * @param {Number} options.level\n   * @param {Number} options.faceIndex\n   * @param {HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | ArrayBufferView} options.image\n   * @param {Boolean} options.flipY\n   * @param {Boolean} options.premultiplyAlpha\n   */\n  updateImage(options) {\n    let gl = this._device._gl;\n    let glFmt = glTextureFmt(this._format);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._glID);\n    this._setImage(glFmt, options);\n    this._device._restoreTexture(0);\n  }\n\n  _setSubImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let faceIndex = options.faceIndex;\n    let img = options.image;\n\n    if (flipY === undefined) {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n    }\n\n    if (premultiplyAlpha === undefined) {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n    }\n\n    if (\n      img instanceof HTMLCanvasElement ||\n      img instanceof HTMLImageElement ||\n      img instanceof HTMLVideoElement\n    ) {\n      gl.texSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex, options.level, options.x, options.y, glFmt.format, glFmt.pixelType, img);\n    } else {\n      if (this._compressed) {\n        gl.compressedTexSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          img\n        );\n      } else {\n        gl.texSubImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          options.x,\n          options.y,\n          options.width,\n          options.height,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  _setImage(glFmt, options) {\n    let gl = this._device._gl;\n    let flipY = options.flipY;\n    let premultiplyAlpha = options.premultiplyAlpha;\n    let faceIndex = options.faceIndex;\n    let img = options.image;\n\n    if (flipY === undefined) {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\n    }\n\n    if (premultiplyAlpha === undefined) {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    } else {\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\n    }\n    if (\n      img instanceof HTMLCanvasElement ||\n      img instanceof HTMLImageElement ||\n      img instanceof HTMLVideoElement\n    ) {\n      gl.texImage2D(\n        gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n        options.level,\n        glFmt.internalFormat,\n        glFmt.format,\n        glFmt.pixelType,\n        img\n      );\n    } else {\n      if (this._compressed) {\n        gl.compressedTexImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          img\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex,\n          options.level,\n          glFmt.internalFormat,\n          options.width,\n          options.height,\n          0,\n          glFmt.format,\n          glFmt.pixelType,\n          img\n        );\n      }\n    }\n  }\n\n  // levelImages = [imagePosX, imageNegX, imagePosY, imageNegY, imagePosZ, imageNegz]\n  // images = [levelImages0, levelImages1, ...]\n  _setMipmap(images, flipY, premultiplyAlpha) {\n    let glFmt = glTextureFmt(this._format);\n    let options = {\n      width: this._width,\n      height: this._height,\n      faceIndex : 0,\n      flipY: flipY,\n      premultiplyAlpha: premultiplyAlpha,\n      level: 0,\n      image: null\n    };\n\n    for (let i = 0; i < images.length; ++i) {\n      let levelImages = images[i];\n      options.level = i;\n      options.width = this._width >> i;\n      options.height = this._height >> i;\n\n      for (let face = 0; face < 6; ++face) {\n        options.faceIndex = face;\n        options.image = levelImages[face];\n        this._setImage(glFmt, options);\n      }\n    }\n  }\n\n  _setTexInfo() {\n    let gl = this._device._gl;\n\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, glFilter(gl, this._minFilter, this._hasMipmap ? this._mipFilter : -1));\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, glFilter(gl, this._magFilter, -1));\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, this._wrapS);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, this._wrapT);\n    // wrapR available in webgl2\n    // gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_R, this._wrapR);\n\n    let ext = this._device.ext('EXT_texture_filter_anisotropic');\n    if (ext) {\n      gl.texParameteri(gl.TEXTURE_CUBE_MAP, ext.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);\n    }\n  }\n}\n","export default class RenderBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {RB_FMT_*} format\n   * @param {Number} width\n   * @param {Number} height\n   */\n  constructor(device, format, width, height) {\n    this._device = device;\n    this._format = format;\n    this._width = width;\n    this._height = height;\n\n    const gl = device._gl;\n    this._glID = gl.createRenderbuffer();\n\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this._glID);\n    gl.renderbufferStorage(gl.RENDERBUFFER, format, width, height);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === null) {\n      console.error('The render-buffer already destroyed');\n      return;\n    }\n\n    const gl = this._device._gl;\n\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.deleteRenderbuffer(this._glID);\n\n    this._glID = null;\n  }\n}","export default class FrameBuffer {\n  /**\n   * @constructor\n   * @param {Device} device\n   * @param {Number} width\n   * @param {Number} height\n   * @param {Object} options\n   * @param {Array} options.colors\n   * @param {RenderBuffer|Texture2D|TextureCube} options.depth\n   * @param {RenderBuffer|Texture2D|TextureCube} options.stencil\n   * @param {RenderBuffer|Texture2D|TextureCube} options.depthStencil\n   */\n  constructor(device, width, height, options) {\n    this._device = device;\n    this._width = width;\n    this._height = height;\n\n    this._colors = options.colors || [];\n    this._depth = options.depth || null;\n    this._stencil = options.stencil || null;\n    this._depthStencil = options.depthStencil || null;\n\n    this._glID = device._gl.createFramebuffer();\n  }\n\n  /**\n   * @method destroy\n   */\n  destroy() {\n    if (this._glID === null) {\n      console.error('The frame-buffer already destroyed');\n      return;\n    }\n\n    const gl = this._device._gl;\n\n    gl.deleteFramebuffer(this._glID);\n\n    this._glID = null;\n  }\n}","import { enums } from './enums';\n\nconst _default = {\n  // blend\n  blend: false,\n  blendSep: false,\n  blendColor: 0xffffffff,\n  blendEq: enums.BLEND_FUNC_ADD,\n  blendAlphaEq: enums.BLEND_FUNC_ADD,\n  blendSrc: enums.BLEND_ONE,\n  blendDst: enums.BLEND_ZERO,\n  blendSrcAlpha: enums.BLEND_ONE,\n  blendDstAlpha: enums.BLEND_ZERO,\n\n  // depth\n  depthTest: false,\n  depthWrite: false,\n  depthFunc: enums.DS_FUNC_LESS,\n\n  // stencil\n  stencilTest: false,\n  stencilSep: false,\n  stencilFuncFront: enums.DS_FUNC_ALWAYS,\n  stencilRefFront: 0,\n  stencilMaskFront: 0xff,\n  stencilFailOpFront: enums.STENCIL_OP_KEEP,\n  stencilZFailOpFront: enums.STENCIL_OP_KEEP,\n  stencilZPassOpFront: enums.STENCIL_OP_KEEP,\n  stencilWriteMaskFront: 0xff,\n  stencilFuncBack: enums.DS_FUNC_ALWAYS,\n  stencilRefBack: 0,\n  stencilMaskBack: 0xff,\n  stencilFailOpBack: enums.STENCIL_OP_KEEP,\n  stencilZFailOpBack: enums.STENCIL_OP_KEEP,\n  stencilZPassOpBack: enums.STENCIL_OP_KEEP,\n  stencilWriteMaskBack: 0xff,\n\n  // cull-mode\n  cullMode: enums.CULL_BACK,\n\n  // primitive-type\n  primitiveType: enums.PT_TRIANGLES,\n\n  // bindings\n  maxStream: -1,\n  vertexBuffers: [],\n  vertexBufferOffsets: [],\n  indexBuffer: null,\n  textureUnits: [],\n  program: null,\n};\n\nexport default class State {\n  constructor() {\n    // bindings\n    this.vertexBuffers = [];\n    this.vertexBufferOffsets = [];\n    this.textureUnits = [];\n\n    this.set(_default);\n  }\n\n  reset () {\n    this.set(_default);\n  }\n\n  set (cpy) {\n    // blending\n    this.blend = cpy.blend;\n    this.blendSep = cpy.blendSep;\n    this.blendColor = cpy.blendColor;\n    this.blendEq = cpy.blendEq;\n    this.blendAlphaEq = cpy.blendAlphaEq;\n    this.blendSrc = cpy.blendSrc;\n    this.blendDst = cpy.blendDst;\n    this.blendSrcAlpha = cpy.blendSrcAlpha;\n    this.blendDstAlpha = cpy.blendDstAlpha;\n\n    // depth\n    this.depthTest = cpy.depthTest;\n    this.depthWrite = cpy.depthWrite;\n    this.depthFunc = cpy.depthFunc;\n\n    // stencil\n    this.stencilTest = cpy.stencilTest;\n    this.stencilSep = cpy.stencilSep;\n    this.stencilFuncFront = cpy.stencilFuncFront;\n    this.stencilRefFront = cpy.stencilRefFront;\n    this.stencilMaskFront = cpy.stencilMaskFront;\n    this.stencilFailOpFront = cpy.stencilFailOpFront;\n    this.stencilZFailOpFront = cpy.stencilZFailOpFront;\n    this.stencilZPassOpFront = cpy.stencilZPassOpFront;\n    this.stencilWriteMaskFront = cpy.stencilWriteMaskFront;\n    this.stencilFuncBack = cpy.stencilFuncBack;\n    this.stencilRefBack = cpy.stencilRefBack;\n    this.stencilMaskBack = cpy.stencilMaskBack;\n    this.stencilFailOpBack = cpy.stencilFailOpBack;\n    this.stencilZFailOpBack = cpy.stencilZFailOpBack;\n    this.stencilZPassOpBack = cpy.stencilZPassOpBack;\n    this.stencilWriteMaskBack = cpy.stencilWriteMaskBack;\n\n    // cull-mode\n    this.cullMode = cpy.cullMode;\n\n    // primitive-type\n    this.primitiveType = cpy.primitiveType;\n\n    // bindings\n    this.maxStream = cpy.maxStream;\n    for (let i = 0; i < cpy.vertexBuffers.length; ++i) {\n      this.vertexBuffers[i] = cpy.vertexBuffers[i];\n    }\n    for (let i = 0; i < cpy.vertexBufferOffsets.length; ++i) {\n      this.vertexBufferOffsets[i] = cpy.vertexBufferOffsets[i];\n    }\n    this.indexBuffer = cpy.indexBuffer;\n    for (let i = 0; i < cpy.textureUnits.length; ++i) {\n      this.textureUnits[i] = cpy.textureUnits[i];\n    }\n    this.program = cpy.program;\n  }\n}","import State from './state';\nimport { enums } from './enums';\n\nimport Texture2D from './texture-2d';\nimport TextureCube from './texture-cube';\n\nconst GL_INT = 5124;\nconst GL_FLOAT = 5126;\nconst GL_FLOAT_VEC2 = 35664;\nconst GL_FLOAT_VEC3 = 35665;\nconst GL_FLOAT_VEC4 = 35666;\nconst GL_INT_VEC2 = 35667;\nconst GL_INT_VEC3 = 35668;\nconst GL_INT_VEC4 = 35669;\nconst GL_BOOL = 35670;\nconst GL_BOOL_VEC2 = 35671;\nconst GL_BOOL_VEC3 = 35672;\nconst GL_BOOL_VEC4 = 35673;\nconst GL_FLOAT_MAT2 = 35674;\nconst GL_FLOAT_MAT3 = 35675;\nconst GL_FLOAT_MAT4 = 35676;\nconst GL_SAMPLER_2D = 35678;\nconst GL_SAMPLER_CUBE = 35680;\n\n/**\n * _type2uniformCommit\n */\nlet _type2uniformCommit = {\n  [GL_INT]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_FLOAT]: function (gl, id, value) {\n    gl.uniform1f(id, value);\n  },\n\n  [GL_FLOAT_VEC2]: function (gl, id, value) {\n    gl.uniform2fv(id, value);\n  },\n\n  [GL_FLOAT_VEC3]: function (gl, id, value) {\n    gl.uniform3fv(id, value);\n  },\n\n  [GL_FLOAT_VEC4]: function (gl, id, value) {\n    gl.uniform4fv(id, value);\n  },\n\n  [GL_INT_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_INT_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_INT_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_BOOL]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_BOOL_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_BOOL_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_BOOL_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_FLOAT_MAT2]: function (gl, id, value) {\n    gl.uniformMatrix2fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT3]: function (gl, id, value) {\n    gl.uniformMatrix3fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT4]: function (gl, id, value) {\n    gl.uniformMatrix4fv(id, false, value);\n  },\n\n  [GL_SAMPLER_2D]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n\n  [GL_SAMPLER_CUBE]: function (gl, id, value) {\n    gl.uniform1i(id, value);\n  },\n};\n\n/**\n * _type2uniformArrayCommit\n */\nlet _type2uniformArrayCommit = {\n  [GL_INT]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_FLOAT]: function (gl, id, value) {\n    gl.uniform1fv(id, value);\n  },\n\n  [GL_FLOAT_VEC2]: function (gl, id, value) {\n    gl.uniform2fv(id, value);\n  },\n\n  [GL_FLOAT_VEC3]: function (gl, id, value) {\n    gl.uniform3fv(id, value);\n  },\n\n  [GL_FLOAT_VEC4]: function (gl, id, value) {\n    gl.uniform4fv(id, value);\n  },\n\n  [GL_INT_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_INT_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_INT_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_BOOL]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_BOOL_VEC2]: function (gl, id, value) {\n    gl.uniform2iv(id, value);\n  },\n\n  [GL_BOOL_VEC3]: function (gl, id, value) {\n    gl.uniform3iv(id, value);\n  },\n\n  [GL_BOOL_VEC4]: function (gl, id, value) {\n    gl.uniform4iv(id, value);\n  },\n\n  [GL_FLOAT_MAT2]: function (gl, id, value) {\n    gl.uniformMatrix2fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT3]: function (gl, id, value) {\n    gl.uniformMatrix3fv(id, false, value);\n  },\n\n  [GL_FLOAT_MAT4]: function (gl, id, value) {\n    gl.uniformMatrix4fv(id, false, value);\n  },\n\n  [GL_SAMPLER_2D]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n\n  [GL_SAMPLER_CUBE]: function (gl, id, value) {\n    gl.uniform1iv(id, value);\n  },\n};\n\n/**\n * _commitBlendStates\n */\nfunction _commitBlendStates(gl, cur, next) {\n  // enable/disable blend\n  if (cur.blend !== next.blend) {\n    if (!next.blend) {\n      gl.disable(gl.BLEND);\n      return;\n    }\n\n    gl.enable(gl.BLEND);\n\n    if (\n      next.blendSrc === enums.BLEND_CONSTANT_COLOR ||\n      next.blendSrc === enums.BLEND_ONE_MINUS_CONSTANT_COLOR ||\n      next.blendDst === enums.BLEND_CONSTANT_COLOR ||\n      next.blendDst === enums.BLEND_ONE_MINUS_CONSTANT_COLOR\n    ) {\n      gl.blendColor(\n        (next.blendColor >> 24) / 255,\n        (next.blendColor >> 16 & 0xff) / 255,\n        (next.blendColor >> 8 & 0xff) / 255,\n        (next.blendColor & 0xff) / 255\n      );\n    }\n\n    if (next.blendSep) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    } else {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n      gl.blendEquation(next.blendEq);\n    }\n\n    return;\n  }\n\n  // nothing to update\n  if (next.blend === false) {\n    return;\n  }\n\n  // blend-color\n  if (cur.blendColor !== next.blendColor) {\n    gl.blendColor(\n      (next.blendColor >> 24) / 255,\n      (next.blendColor >> 16 & 0xff) / 255,\n      (next.blendColor >> 8 & 0xff) / 255,\n      (next.blendColor & 0xff) / 255\n    );\n  }\n\n  // separate diff, reset all\n  if (cur.blendSep !== next.blendSep) {\n    if (next.blendSep) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    } else {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n      gl.blendEquation(next.blendEq);\n    }\n\n    return;\n  }\n\n  if (next.blendSep) {\n    // blend-func-separate\n    if (\n      cur.blendSrc !== next.blendSrc ||\n      cur.blendDst !== next.blendDst ||\n      cur.blendSrcAlpha !== next.blendSrcAlpha ||\n      cur.blendDstAlpha !== next.blendDstAlpha\n    ) {\n      gl.blendFuncSeparate(next.blendSrc, next.blendDst, next.blendSrcAlpha, next.blendDstAlpha);\n    }\n\n    // blend-equation-separate\n    if (\n      cur.blendEq !== next.blendEq ||\n      cur.blendAlphaEq !== next.blendAlphaEq\n    ) {\n      gl.blendEquationSeparate(next.blendEq, next.blendAlphaEq);\n    }\n  } else {\n    // blend-func\n    if (\n      cur.blendSrc !== next.blendSrc ||\n      cur.blendDst !== next.blendDst\n    ) {\n      gl.blendFunc(next.blendSrc, next.blendDst);\n    }\n\n    // blend-equation\n    if (cur.blendEq !== next.blendEq) {\n      gl.blendEquation(next.blendEq);\n    }\n  }\n}\n\n/**\n * _commitDepthStates\n */\nfunction _commitDepthStates(gl, cur, next) {\n  // enable/disable depth-test\n  if (cur.depthTest !== next.depthTest) {\n    if (!next.depthTest) {\n      gl.disable(gl.DEPTH_TEST);\n      return;\n    }\n\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(next.depthFunc);\n    gl.depthMask(next.depthWrite);\n\n    return;\n  }\n\n  // commit depth-write\n  if (cur.depthWrite !== next.depthWrite) {\n    gl.depthMask(next.depthWrite);\n  }\n\n  // check if depth-write enabled\n  if (next.depthTest === false) {\n    if (next.depthWrite) {\n      next.depthTest = true;\n      next.depthFunc = enums.DS_FUNC_ALWAYS;\n\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthFunc(next.depthFunc);\n    }\n\n    return;\n  }\n\n  // depth-func\n  if (cur.depthFunc !== next.depthFunc) {\n    gl.depthFunc(next.depthFunc);\n  }\n}\n\n/**\n * _commitStencilStates\n */\nfunction _commitStencilStates(gl, cur, next) {\n  if (next.stencilTest !== cur.stencilTest) {\n    if (!next.stencilTest) {\n      gl.disable(gl.STENCIL_TEST);\n      return;\n    }\n\n    gl.enable(gl.STENCIL_TEST);\n\n    if (next.stencilSep) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    } else {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMask(next.stencilWriteMaskFront);\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n\n    return;\n  }\n\n  // fast return\n  if (!next.stencilTest) {\n    return;\n  }\n\n  if (cur.stencilSep !== next.stencilSep) {\n    if (next.stencilSep) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    } else {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n      gl.stencilMask(next.stencilWriteMaskFront);\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n    return;\n  }\n\n  if (next.stencilSep) {\n    // front\n    if (\n      cur.stencilFuncFront !== next.stencilFuncFront ||\n      cur.stencilRefFront !== next.stencilRefFront ||\n      cur.stencilMaskFront !== next.stencilMaskFront\n    ) {\n      gl.stencilFuncSeparate(gl.FRONT, next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n    }\n    if (cur.stencilWriteMaskFront !== next.stencilWriteMaskFront) {\n      gl.stencilMaskSeparate(gl.FRONT, next.stencilWriteMaskFront);\n    }\n    if (\n      cur.stencilFailOpFront !== next.stencilFailOpFront ||\n      cur.stencilZFailOpFront !== next.stencilZFailOpFront ||\n      cur.stencilZPassOpFront !== next.stencilZPassOpFront\n    ) {\n      gl.stencilOpSeparate(gl.FRONT, next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n\n    // back\n    if (\n      cur.stencilFuncBack !== next.stencilFuncBack ||\n      cur.stencilRefBack !== next.stencilRefBack ||\n      cur.stencilMaskBack !== next.stencilMaskBack\n    ) {\n      gl.stencilFuncSeparate(gl.BACK, next.stencilFuncBack, next.stencilRefBack, next.stencilMaskBack);\n    }\n    if (cur.stencilWriteMaskBack !== next.stencilWriteMaskBack) {\n      gl.stencilMaskSeparate(gl.BACK, next.stencilWriteMaskBack);\n    }\n    if (\n      cur.stencilFailOpBack !== next.stencilFailOpBack ||\n      cur.stencilZFailOpBack !== next.stencilZFailOpBack ||\n      cur.stencilZPassOpBack !== next.stencilZPassOpBack\n    ) {\n      gl.stencilOpSeparate(gl.BACK, next.stencilFailOpBack, next.stencilZFailOpBack, next.stencilZPassOpBack);\n    }\n  } else {\n    if (\n      cur.stencilFuncFront !== next.stencilFuncFront ||\n      cur.stencilRefFront !== next.stencilRefFront ||\n      cur.stencilMaskFront !== next.stencilMaskFront\n    ) {\n      gl.stencilFunc(next.stencilFuncFront, next.stencilRefFront, next.stencilMaskFront);\n    }\n    if (cur.stencilWriteMaskFront !== next.stencilWriteMaskFront) {\n      gl.stencilMask(next.stencilWriteMaskFront);\n    }\n    if (\n      cur.stencilFailOpFront !== next.stencilFailOpFront ||\n      cur.stencilZFailOpFront !== next.stencilZFailOpFront ||\n      cur.stencilZPassOpFront !== next.stencilZPassOpFront\n    ) {\n      gl.stencilOp(next.stencilFailOpFront, next.stencilZFailOpFront, next.stencilZPassOpFront);\n    }\n  }\n\n}\n\n/**\n * _commitCullMode\n */\nfunction _commitCullMode(gl, cur, next) {\n  if (cur.cullMode === next.cullMode) {\n    return;\n  }\n\n  if (next.cullMode === enums.CULL_NONE) {\n    gl.disable(gl.CULL_FACE);\n    return;\n  }\n\n  gl.enable(gl.CULL_FACE);\n  gl.cullFace(next.cullMode);\n}\n\n/**\n * _commitVertexBuffers\n */\nfunction _commitVertexBuffers(gl, cur, next) {\n  let attrsDirty = false;\n\n  // nothing changed for vertex buffer\n  if (next.maxStream === -1) {\n    console.warn('VertexBuffer not assigned, please call setVertexBuffer before every draw.');\n    return;\n  }\n\n  if (cur.maxStream !== next.maxStream) {\n    attrsDirty = true;\n  } else if (cur.program !== next.program) {\n    attrsDirty = true;\n  } else {\n    for (let i = 0; i < next.maxStream + 1; ++i) {\n      if (\n        cur.vertexBuffers[i] !== next.vertexBuffers[i] ||\n        cur.vertexBufferOffsets[i] !== next.vertexBufferOffsets[i]\n      ) {\n        attrsDirty = true;\n        break;\n      }\n    }\n  }\n\n  if (attrsDirty) {\n    for (let i = 0; i < next.maxStream + 1; ++i) {\n      let vb = next.vertexBuffers[i];\n      let vbOffset = next.vertexBufferOffsets[i];\n      if (!vb) {\n        continue;\n      }\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, vb._glID);\n\n      for (let j = 0; j < next.program._attributes.length; ++j) {\n        let attr = next.program._attributes[j];\n\n        let el = vb._format.element(attr.name);\n        if (!el) {\n          console.warn(`Can not find vertex attribute: ${attr.name}`);\n          continue;\n        }\n\n        gl.enableVertexAttribArray(attr.location);\n        gl.vertexAttribPointer(\n          attr.location,\n          el.num,\n          el.type,\n          el.normalize,\n          el.stride,\n          el.offset + vbOffset * el.stride\n        );\n      }\n    }\n  }\n}\n\n/**\n * _commitTextures\n */\nfunction _commitTextures(gl, cur, next) {\n  for (let i = 0; i < next.textureUnits.length; ++i) {\n    if (cur.textureUnits[i] !== next.textureUnits[i]) {\n      let texture = next.textureUnits[i];\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(texture._target, texture._glID);\n    }\n  }\n}\n\n/**\n * _attach\n */\nfunction _attach(gl, location, attachment, face = 0) {\n  if (attachment instanceof Texture2D) {\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      location,\n      gl.TEXTURE_2D,\n      attachment._glID,\n      0\n    );\n  } else if (attachment instanceof TextureCube) {\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      location,\n      gl.TEXTURE_CUBE_MAP_POSITIVE_X + face,\n      attachment._glID,\n      0\n    );\n  } else {\n    gl.framebufferRenderbuffer(\n      gl.FRAMEBUFFER,\n      location,\n      gl.RENDERBUFFER,\n      attachment._glID\n    );\n  }\n}\n\nexport default class Device {\n  /**\n   * @param {HTMLElement} canvasEL\n   * @param {object} opts\n   */\n  constructor(canvasEL, opts) {\n    let gl;\n\n    // default options\n    opts = opts || {};\n    if (opts.alpha === undefined) {\n      opts.alpha = false;\n    }\n    if (opts.stencil === undefined) {\n      opts.stencil = true;\n    }\n    if (opts.depth === undefined) {\n      opts.depth = true;\n    }\n    if (opts.antialias === undefined) {\n      opts.antialias = false;\n    }\n    // NOTE: it is said the performance improved in mobile device with this flag off.\n    if (opts.preserveDrawingBuffer === undefined) {\n      opts.preserveDrawingBuffer = false;\n    }\n\n\n    try {\n      gl = canvasEL.getContext('webgl', opts);\n    } catch (err) {\n      console.error(err);\n      return;\n    }\n\n    // statics\n    this._gl = gl;\n    this._extensions = {};\n    this._caps = {}; // capability\n    this._stats = {\n      texture: 0,\n      vb: 0,\n      ib: 0,\n      drawcalls: 0,\n    };\n\n    // runtime\n    this._current = new State();\n    this._next = new State();\n    this._uniforms = {}; // name: { value, num, dirty }\n    this._vx = this._vy = this._vw = this._vh = 0;\n    this._sx = this._sy = this._sw = this._sh = 0;\n    this._framebuffer = null;\n\n    this._initExtensions([\n      'EXT_texture_filter_anisotropic',\n      'OES_standard_derivatives',\n      'OES_texture_float',\n      'OES_texture_float_linear',\n      'OES_texture_half_float',\n      'OES_texture_half_float_linear',\n      'OES_vertex_array_object',\n      'WEBGL_compressed_texture_atc',\n      'WEBGL_compressed_texture_etc1',\n      'WEBGL_compressed_texture_pvrtc',\n      'WEBGL_compressed_texture_s3tc',\n      'WEBGL_depth_texture',\n      'WEBGL_draw_buffers',\n    ]);\n    this._initCaps();\n    this._initStates();\n  }\n\n  _initExtensions(extensions) {\n    const gl = this._gl;\n\n    for (let i = 0; i < extensions.length; ++i) {\n      let name = extensions[i];\n\n      try {\n        let ext = gl.getExtension(name);\n        if (ext) {\n          this._extensions[name] = ext;\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  }\n\n  _initCaps() {\n    const gl = this._gl;\n    const extDrawBuffers = this.ext('WEBGL_draw_buffers');\n\n    this._caps.maxVertexTextures = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\n    this._caps.maxFragUniforms = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\n    this._caps.maxTextureUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\n\n    this._caps.maxDrawBuffers = extDrawBuffers ? gl.getParameter(extDrawBuffers.MAX_DRAW_BUFFERS_WEBGL) : 1;\n    this._caps.maxColorAttachments = extDrawBuffers ? gl.getParameter(extDrawBuffers.MAX_COLOR_ATTACHMENTS_WEBGL) : 1;\n  }\n\n  _initStates() {\n    const gl = this._gl;\n\n    // gl.frontFace(gl.CCW);\n    gl.disable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ZERO);\n    gl.blendEquation(gl.FUNC_ADD);\n    gl.blendColor(1,1,1,1);\n\n    gl.colorMask(true, true, true, true);\n\n    gl.enable(gl.CULL_FACE);\n    gl.cullFace(gl.BACK);\n\n    gl.disable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LESS);\n    gl.depthMask(false);\n    gl.disable(gl.POLYGON_OFFSET_FILL);\n    gl.depthRange(0,1);\n\n    gl.disable(gl.STENCIL_TEST);\n    gl.stencilFunc(gl.ALWAYS, 0, 0xFF);\n    gl.stencilMask(0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n\n    // TODO:\n    // this.setAlphaToCoverage(false);\n    // this.setTransformFeedbackBuffer(null);\n    // this.setRaster(true);\n    // this.setDepthBias(false);\n\n    gl.clearDepth(1);\n    gl.clearColor(0, 0, 0, 0);\n    gl.clearStencil(0);\n\n    gl.disable(gl.SCISSOR_TEST);\n  }\n\n  _restoreTexture (unit) {\n    const gl = this._gl;\n\n    let texture = this._current.textureUnits[unit];\n    if (texture) {\n      gl.bindTexture(texture._target, texture._glID);\n    } else {\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n  }\n\n  /**\n   * @method ext\n   * @param {string} name\n   */\n  ext(name) {\n    return this._extensions[name];\n  }\n\n  // ===============================\n  // Immediate Settings\n  // ===============================\n\n  /**\n   * @method setFrameBuffer\n   * @param {FrameBuffer} fb - null means use the backbuffer\n   */\n  setFrameBuffer(fb) {\n    if (this._framebuffer === fb) {\n      return;\n    }\n\n    this._framebuffer = fb;\n    const gl = this._gl;\n\n    if (fb === null) {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      return;\n    }\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fb._glID);\n\n    let numColors = this._framebuffer._colors.length;\n    for (let i = 0; i < numColors; ++i) {\n      let colorBuffer = this._framebuffer._colors[i];\n      _attach(gl, gl.COLOR_ATTACHMENT0 + i, colorBuffer);\n\n      // TODO: what about cubemap face??? should be the target parameter for colorBuffer\n    }\n    for (let i = numColors; i < this._caps.maxColorAttachments; ++i) {\n      gl.framebufferTexture2D(\n        gl.FRAMEBUFFER,\n        gl.COLOR_ATTACHMENT0 + i,\n        gl.TEXTURE_2D,\n        null,\n        0\n      );\n    }\n\n    if (this._framebuffer._depth) {\n      _attach(gl, gl.DEPTH_ATTACHMENT, this._framebuffer._depth);\n    }\n\n    if (this._framebuffer._stencil) {\n      _attach(gl, gl.STENCIL_ATTACHMENT, fb._stencil);\n    }\n\n    if (this._framebuffer._depthStencil) {\n      _attach(gl, gl.DEPTH_STENCIL_ATTACHMENT, fb._depthStencil);\n    }\n  }\n\n  /**\n   * @method setViewport\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} w\n   * @param {Number} h\n   */\n  setViewport(x, y, w, h) {\n    if (\n      this._vx !== x ||\n      this._vy !== y ||\n      this._vw !== w ||\n      this._vh !== h\n    ) {\n      this._gl.viewport(x, y, w, h);\n      this._vx = x;\n      this._vy = y;\n      this._vw = w;\n      this._vh = h;\n    }\n  }\n\n  /**\n   * @method setScissor\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} w\n   * @param {Number} h\n   */\n  setScissor(x, y, w, h) {\n    if (\n      this._sx !== x ||\n      this._sy !== y ||\n      this._sw !== w ||\n      this._sh !== h\n    ) {\n      this._gl.scissor(x, y, w, h);\n      this._sx = x;\n      this._sy = y;\n      this._sw = w;\n      this._sh = h;\n    }\n  }\n\n  /**\n   * @method clear\n   * @param {Object} opts\n   * @param {Array} opts.color\n   * @param {Number} opts.depth\n   * @param {Number} opts.stencil\n   */\n  clear(opts) {\n    const gl = this._gl;\n    let flags = 0;\n\n    if (opts.color !== undefined) {\n      flags |= gl.COLOR_BUFFER_BIT;\n      gl.clearColor(opts.color[0], opts.color[1], opts.color[2], opts.color[3]);\n    }\n\n    if (opts.depth !== undefined) {\n      flags |= gl.DEPTH_BUFFER_BIT;\n      gl.clearDepth(opts.depth);\n\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthMask(true);\n      gl.depthFunc(gl.ALWAYS);\n    }\n\n    if (opts.stencil !== undefined) {\n      flags |= gl.STENCIL_BUFFER_BIT;\n      gl.clearStencil(opts.stencil);\n    }\n\n    gl.clear(flags);\n\n    // restore depth-write\n    if (opts.depth !== undefined) {\n      if (this._current.depthTest === false) {\n        gl.disable(gl.DEPTH_TEST);\n      } else {\n        if (this._current.depthWrite === false) {\n          gl.depthMask(false);\n        }\n        if (this._current.depthFunc !== enums.DS_FUNC_ALWAYS) {\n          gl.depthFunc(this._current.depthFunc);\n        }\n      }\n    }\n  }\n\n  // ===============================\n  // Deferred States\n  // ===============================\n\n  /**\n   * @method enableBlend\n   */\n  enableBlend() {\n    this._next.blend = true;\n  }\n\n  /**\n   * @method enableDepthTest\n   */\n  enableDepthTest() {\n    this._next.depthTest = true;\n  }\n\n  /**\n   * @method enableDepthWrite\n   */\n  enableDepthWrite() {\n    this._next.depthWrite = true;\n  }\n\n  /**\n   * @method enableStencilTest\n   */\n  enableStencilTest() {\n    this._next.stencilTest = true;\n  }\n\n  /**\n   * @method setStencilFunc\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFunc(func, ref, mask) {\n    this._next.stencilSep = false;\n    this._next.stencilFuncFront = this._next.stencilFuncBack = func;\n    this._next.stencilRefFront = this._next.stencilRefBack = ref;\n    this._next.stencilMaskFront = this._next.stencilMaskBack = mask;\n  }\n\n  /**\n   * @method setStencilFuncFront\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFuncFront(func, ref, mask) {\n    this._next.stencilSep = true;\n    this._next.stencilFuncFront = func;\n    this._next.stencilRefFront = ref;\n    this._next.stencilMaskFront = mask;\n  }\n\n  /**\n   * @method setStencilFuncBack\n   * @param {DS_FUNC_*} func\n   * @param {Number} ref\n   * @param {Number} mask\n   */\n  setStencilFuncBack(func, ref, mask) {\n    this._next.stencilSep = true;\n    this._next.stencilFuncBack = func;\n    this._next.stencilRefBack = ref;\n    this._next.stencilMaskBack = mask;\n  }\n\n  /**\n   * @method setStencilOp\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOp(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilFailOpFront = this._next.stencilFailOpBack = failOp;\n    this._next.stencilZFailOpFront = this._next.stencilZFailOpBack = zFailOp;\n    this._next.stencilZPassOpFront = this._next.stencilZPassOpBack = zPassOp;\n    this._next.stencilWriteMaskFront = this._next.stencilWriteMaskBack = writeMask;\n  }\n\n  /**\n   * @method setStencilOpFront\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOpFront(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilSep = true;\n    this._next.stencilFailOpFront = failOp;\n    this._next.stencilZFailOpFront = zFailOp;\n    this._next.stencilZPassOpFront = zPassOp;\n    this._next.stencilWriteMaskFront = writeMask;\n  }\n\n  /**\n   * @method setStencilOpBack\n   * @param {STENCIL_OP_*} failOp\n   * @param {STENCIL_OP_*} zFailOp\n   * @param {STENCIL_OP_*} zPassOp\n   * @param {Number} writeMask\n   */\n  setStencilOpBack(failOp, zFailOp, zPassOp, writeMask) {\n    this._next.stencilSep = true;\n    this._next.stencilFailOpBack = failOp;\n    this._next.stencilZFailOpBack = zFailOp;\n    this._next.stencilZPassOpBack = zPassOp;\n    this._next.stencilWriteMaskBack = writeMask;\n  }\n\n  /**\n   * @method setDepthFunc\n   * @param {DS_FUNC_*} depthFunc\n   */\n  setDepthFunc(depthFunc) {\n    this._next.depthFunc = depthFunc;\n  }\n\n  /**\n   * @method setBlendColor32\n   * @param {Number} rgba\n   */\n  setBlendColor32(rgba) {\n    this._next.blendColor = rgba;\n  }\n\n  /**\n   * @method setBlendColor\n   * @param {Number} r\n   * @param {Number} g\n   * @param {Number} b\n   * @param {Number} a\n   */\n  setBlendColor(r, g, b, a) {\n    this._next.blendColor = ((r * 255) << 24 | (g * 255) << 16 | (b * 255) << 8 | a * 255) >>> 0;\n  }\n\n  /**\n   * @method setBlendFunc\n   * @param {BELND_*} src\n   * @param {BELND_*} dst\n   */\n  setBlendFunc(src, dst) {\n    this._next.blendSep = false;\n    this._next.blendSrc = src;\n    this._next.blendDst = dst;\n  }\n\n  /**\n   * @method setBlendFuncSep\n   * @param {BELND_*} src\n   * @param {BELND_*} dst\n   * @param {BELND_*} srcAlpha\n   * @param {BELND_*} dstAlpha\n   */\n  setBlendFuncSep(src, dst, srcAlpha, dstAlpha) {\n    this._next.blendSep = true;\n    this._next.blendSrc = src;\n    this._next.blendDst = dst;\n    this._next.blendSrcAlpha = srcAlpha;\n    this._next.blendDstAlpha = dstAlpha;\n  }\n\n  /**\n   * @method setBlendEq\n   * @param {BELND_FUNC_*} eq\n   */\n  setBlendEq(eq) {\n    this._next.blendSep = false;\n    this._next.blendEq = eq;\n  }\n\n  /**\n   * @method setBlendEqSep\n   * @param {BELND_FUNC_*} eq\n   * @param {BELND_FUNC_*} alphaEq\n   */\n  setBlendEqSep(eq, alphaEq) {\n    this._next.blendSep = true;\n    this._next.blendEq = eq;\n    this._next.blendAlphaEq = alphaEq;\n  }\n\n  /**\n   * @method setCullMode\n   * @param {CULL_*} mode\n   */\n  setCullMode(mode) {\n    this._next.cullMode = mode;\n  }\n\n  /**\n   * @method setVertexBuffer\n   * @param {Number} stream\n   * @param {VertexBuffer} buffer\n   * @param {Number} start - start vertex\n   */\n  setVertexBuffer(stream, buffer, start = 0) {\n    this._next.vertexBuffers[stream] = buffer;\n    this._next.vertexBufferOffsets[stream] = start;\n    if (this._next.maxStream < stream) {\n      this._next.maxStream = stream;\n    }\n  }\n\n  /**\n   * @method setIndexBuffer\n   * @param {IndexBuffer} buffer\n   */\n  setIndexBuffer(buffer) {\n    this._next.indexBuffer = buffer;\n  }\n\n  /**\n   * @method setProgram\n   * @param {Program} program\n   */\n  setProgram(program) {\n    this._next.program = program;\n  }\n\n  /**\n   * @method setTexture\n   * @param {String} name\n   * @param {Texture} texture\n   * @param {Number} slot\n   */\n  setTexture(name, texture, slot) {\n    if (slot >= this._caps.maxTextureUnits) {\n      console.warn(`Can not set texture ${name} at stage ${slot}, max texture exceed: ${this._caps.maxTextureUnits}`);\n      return;\n    }\n\n    this._next.textureUnits[slot] = texture;\n    this.setUniform(name, slot);\n  }\n\n  /**\n   * @method setTextureArray\n   * @param {String} name\n   * @param {Array} textures\n   * @param {Int32Array} slots\n   */\n  setTextureArray(name, textures, slots) {\n    let len = textures.length;\n    if (len >= this._caps.maxTextureUnits) {\n      console.warn(`Can not set ${len} textures for ${name}, max texture exceed: ${this._caps.maxTextureUnits}`);\n      return;\n    }\n    for (let i = 0; i < len; ++i) {\n      let slot = slots[i];\n      this._next.textureUnits[slot] = textures[i];\n    }\n    this.setUniform(name, slots);\n  }\n\n  /**\n   * @method setUniform\n   * @param {String} name\n   * @param {*} value\n   */\n  setUniform(name, value) {\n    let uniform = this._uniforms[name];\n    if (!uniform) {\n      uniform = {\n        dirty: true,\n        value: value,\n      };\n    } else {\n      uniform.dirty = true;\n      uniform.value = value;\n    }\n    this._uniforms[name] = uniform;\n  }\n\n  /**\n   * @method setPrimitiveType\n   * @param {PT_*} type\n   */\n  setPrimitiveType(type) {\n    this._next.primitiveType = type;\n  }\n\n  /**\n   * @method draw\n   * @param {Number} base\n   * @param {Number} count\n   */\n  draw(base, count) {\n    const gl = this._gl;\n    let cur = this._current;\n    let next = this._next;\n\n    // commit blend\n    _commitBlendStates(gl, cur, next);\n\n    // commit depth\n    _commitDepthStates(gl, cur, next);\n\n    // commit stencil\n    _commitStencilStates(gl, cur, next);\n\n    // commit cull\n    _commitCullMode(gl, cur, next);\n\n    // commit vertex-buffer\n    _commitVertexBuffers(gl, cur, next);\n\n    // commit index-buffer\n    if (cur.indexBuffer !== next.indexBuffer) {\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, next.indexBuffer ? next.indexBuffer._glID : null);\n    }\n\n    // commit program\n    let programDirty = false;\n    if (cur.program !== next.program) {\n      if (next.program._linked) {\n        gl.useProgram(next.program._glID);\n      } else {\n        console.warn('Failed to use program: has not linked yet.');\n      }\n      programDirty = true;\n    }\n\n    // commit texture/sampler\n    _commitTextures(gl, cur, next);\n\n    // commit uniforms\n    for (let i = 0; i < next.program._uniforms.length; ++i) {\n      let uniformInfo = next.program._uniforms[i];\n      let uniform = this._uniforms[uniformInfo.name];\n      if (!uniform) {\n        // console.warn(`Can not find uniform ${uniformInfo.name}`);\n        continue;\n      }\n\n      if (!programDirty && !uniform.dirty) {\n        continue;\n      }\n\n      uniform.dirty = false;\n\n      // TODO: please consider array uniform: uniformInfo.size > 0\n\n      let commitFunc = (uniformInfo.size === undefined) ? _type2uniformCommit[uniformInfo.type] : _type2uniformArrayCommit[uniformInfo.type];\n      if (!commitFunc) {\n        console.warn(`Can not find commit function for uniform ${uniformInfo.name}`);\n        continue;\n      }\n\n      commitFunc(gl, uniformInfo.location, uniform.value);\n    }\n\n    // drawPrimitives\n    if (next.indexBuffer) {\n      gl.drawElements(\n        this._next.primitiveType,\n        count,\n        next.indexBuffer._format,\n        base * next.indexBuffer._bytes\n      );\n    } else {\n      gl.drawArrays(\n        this._next.primitiveType,\n        base,\n        count\n      );\n    }\n\n    // TODO: autogen mipmap for color buffer\n    // if (this._framebuffer && this._framebuffer.colors[0].mipmap) {\n    //   gl.bindTexture(this._framebuffer.colors[i]._target, colors[i]._glID);\n    //   gl.generateMipmap(this._framebuffer.colors[i]._target);\n    // }\n\n    // update stats\n    this._stats.drawcalls += 1;\n\n    // reset states\n    cur.set(next);\n    next.reset();\n  }\n}","import {\n  enums,\n  attrTypeBytes,\n  glFilter,\n  glTextureFmt,\n} from './lib/enums';\n\nimport VertexFormat from './lib/vertex-format';\nimport IndexBuffer from './lib/index-buffer';\nimport VertexBuffer from './lib/vertex-buffer';\nimport Program from './lib/program';\nimport Texture from './lib/texture';\nimport Texture2D from './lib/texture-2d';\nimport TextureCube from './lib/texture-cube';\nimport RenderBuffer from './lib/render-buffer';\nimport FrameBuffer from './lib/frame-buffer';\nimport Device from './lib/device';\n\nlet gfx = {\n  // classes\n  VertexFormat,\n  IndexBuffer,\n  VertexBuffer,\n  Program,\n  Texture,\n  Texture2D,\n  TextureCube,\n  RenderBuffer,\n  FrameBuffer,\n  Device,\n\n  // functions\n  attrTypeBytes,\n  glFilter,\n  glTextureFmt,\n};\nObject.assign(gfx, enums);\n\nexport default gfx;"],"names":["const","let","i","len","el","this","prototypeAccessors","info","location","super","GL_FLOAT"],"mappings":";;;;;;;;;;AAAAA,IAAM,UAAU,GAAG,IAAI,CAAC;AACxBA,IAAM,SAAS,GAAG,IAAI,CAAC;AACvBA,IAAM,yBAAyB,GAAG,IAAI,CAAC;AACvCA,IAAM,wBAAwB,GAAG,IAAI,CAAC;AACtCA,IAAM,wBAAwB,GAAG,IAAI,CAAC;AACtCA,IAAM,uBAAuB,GAAG,IAAI,CAAC;;;AAGrCA,IAAM,gBAAgB,GAAG,IAAI,CAAC;;AAE9BA,IAAM,iBAAiB,GAAG,IAAI,CAAC;AAC/BA,IAAM,eAAe,GAAG,IAAI,CAAC;AAC7BA,IAAM,QAAQ,GAAG,IAAI,CAAC;AACtBA,IAAM,uBAAuB,GAAG,KAAK,CAAC;AACtCA,IAAM,yBAAyB,GAAG,KAAK,CAAC;AACxCA,IAAM,yBAAyB,GAAG,KAAK,CAAC;AACxCA,IAAM,iBAAiB,GAAG,KAAK,CAAC;;AAEhCA,IAAM,kBAAkB,GAAG,IAAI,CAAC;;AAEhCA,IAAM,QAAQ,GAAG,IAAI,CAAC;AACtBA,IAAM,MAAM,GAAG,IAAI,CAAC;AACpBA,IAAM,OAAO,GAAG,IAAI,CAAC;AACrBA,IAAM,YAAY,GAAG,IAAI,CAAC;AAC1BA,IAAM,kBAAkB,GAAG,IAAI,CAAC;;AAEhCA,IAAM,+BAA+B,GAAG,MAAM,CAAC;AAC/CA,IAAM,gCAAgC,GAAG,MAAM,CAAC;AAChDA,IAAM,gCAAgC,GAAG,MAAM,CAAC;AAChDA,IAAM,gCAAgC,GAAG,MAAM,CAAC;;AAEhDA,IAAM,kCAAkC,GAAG,MAAM,CAAC;AAClDA,IAAM,kCAAkC,GAAG,MAAM,CAAC;AAClDA,IAAM,mCAAmC,GAAG,MAAM,CAAC;AACnDA,IAAM,mCAAmC,GAAG,MAAM,CAAC;;AAEnDA,IAAM,4BAA4B,GAAG,MAAM,CAAC;;AAE5CA,IAAM,SAAS,GAAG;EAChB,EAAE,UAAU,GAAG,yBAAyB,EAAE,wBAAwB,EAAE;EACpE,EAAE,SAAS,GAAG,wBAAwB,EAAE,uBAAuB,EAAE,EAClE,CAAC;;AAEFA,IAAM,aAAa,GAAG;;EAEpB,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,+BAA+B,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGpF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,gCAAgC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGtF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,gCAAgC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGtF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,gCAAgC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGtF,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,4BAA4B,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGjF,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,kCAAkC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,mCAAmC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGzF,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,kCAAkC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,mCAAmC,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGzF,EAAE,MAAM,EAAE,QAAQ,EAAE,cAAc,EAAE,QAAQ,EAAE,SAAS,EAAE,gBAAgB,EAAE;;;EAG3E,EAAE,MAAM,EAAE,YAAY,EAAE,cAAc,EAAE,YAAY,EAAE,SAAS,EAAE,gBAAgB,EAAE;;;EAGnF,EAAE,MAAM,EAAE,kBAAkB,EAAE,cAAc,EAAE,kBAAkB,EAAE,SAAS,EAAE,gBAAgB,EAAE;;;EAG/F,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,MAAM,EAAE,SAAS,EAAE,uBAAuB,EAAE;;;EAG9E,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,yBAAyB,EAAE;;;EAGlF,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,yBAAyB,EAAE;;;EAGlF,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,MAAM,EAAE,SAAS,EAAE,gBAAgB,EAAE;;;EAGvE,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,gBAAgB,EAAE;;;EAGzE,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,MAAM,EAAE,SAAS,EAAE,iBAAiB,EAAE;;;EAGxE,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,iBAAiB,EAAE;;;EAG1E,EAAE,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE;;;EAG/D,EAAE,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE;;;EAGjE,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvD,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvD,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvD,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE;;;EAGvD,EAAE,MAAM,EAAE,kBAAkB,EAAE,cAAc,EAAE,kBAAkB,EAAE,SAAS,EAAE,iBAAiB,EAAE;;;EAGhG,EAAE,MAAM,EAAE,kBAAkB,EAAE,cAAc,EAAE,kBAAkB,EAAE,SAAS,EAAE,eAAe,EAAE;;;EAG9F,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,EACxD,CAAC;;;;;AAKF,AAAOA,IAAM,KAAK,GAAG;;EAEnB,YAAY,EAAE,KAAK;EACnB,aAAa,EAAE,KAAK;EACpB,YAAY,EAAE,KAAK;;;EAGnB,eAAe,EAAE,IAAI;EACrB,gBAAgB,EAAE,IAAI;EACtB,gBAAgB,EAAE,IAAI;;;EAGtB,aAAa,EAAE,YAAY;EAC3B,WAAW,EAAE,UAAU;EACvB,YAAY,EAAE,WAAW;EACzB,cAAc,EAAE,aAAa;EAC7B,WAAW,EAAE,UAAU;EACvB,YAAY,EAAE,WAAW;EACzB,UAAU,EAAE,SAAS;EACrB,WAAW,EAAE,UAAU;EACvB,WAAW,EAAE,UAAU;EACvB,OAAO,EAAE,MAAM;EACf,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;EACjB,QAAQ,EAAE,OAAO;;;EAGjB,cAAc,EAAE,IAAI;EACpB,eAAe,EAAE,IAAI;EACrB,eAAe,EAAE,IAAI;EACrB,gBAAgB,EAAE,IAAI;EACtB,eAAe,EAAE,IAAI;EACrB,gBAAgB,EAAE,IAAI;EACtB,iBAAiB,EAAE,IAAI;;;EAGvB,cAAc,EAAE,CAAC;EACjB,aAAa,EAAE,CAAC;;;EAGhB,WAAW,EAAE,KAAK;EAClB,UAAU,EAAE,KAAK;EACjB,WAAW,EAAE,KAAK;;;;EAIlB,oBAAoB,EAAE,CAAC;EACvB,qBAAqB,EAAE,CAAC;EACxB,qBAAqB,EAAE,CAAC;EACxB,qBAAqB,EAAE,CAAC;EACxB,oBAAoB,EAAE,CAAC;EACvB,4BAA4B,EAAE,CAAC;EAC/B,6BAA6B,EAAE,CAAC;EAChC,4BAA4B,EAAE,CAAC;EAC/B,6BAA6B,EAAE,CAAC;;;EAGhC,cAAc,EAAE,CAAC;EACjB,cAAc,EAAE,EAAE;EAClB,iBAAiB,EAAE,EAAE;EACrB,oBAAoB,EAAE,EAAE;EACxB,uBAAuB,EAAE,EAAE;EAC3B,uBAAuB,EAAE,EAAE;EAC3B,gBAAgB,EAAE,EAAE;EACpB,iBAAiB,EAAE,EAAE;EACrB,kBAAkB,EAAE,EAAE;EACtB,mBAAmB,EAAE,EAAE;EACvB,kBAAkB,EAAE,EAAE;EACtB,mBAAmB,EAAE,EAAE;EACvB,gBAAgB,EAAE,EAAE;EACpB,mBAAmB,EAAE,EAAE;EACvB,gBAAgB,EAAE,EAAE;EACpB,iBAAiB,EAAE,EAAE;;;EAGrB,eAAe,EAAE,EAAE;EACnB,eAAe,EAAE,EAAE;EACnB,iBAAiB,EAAE,EAAE;;;EAGrB,aAAa,EAAE,GAAG;EAClB,YAAY,EAAE,GAAG;EACjB,aAAa,EAAE,GAAG;EAClB,cAAc,EAAE,GAAG;EACnB,eAAe,EAAE,GAAG;EACpB,gBAAgB,EAAE,GAAG;EACrB,cAAc,EAAE,GAAG;EACnB,cAAc,EAAE,GAAG;;;EAGnB,YAAY,EAAE,KAAK;EACnB,cAAc,EAAE,KAAK;EACrB,aAAa,EAAE,KAAK;EACpB,UAAU,EAAE,KAAK;EACjB,SAAS,EAAE,KAAK;EAChB,YAAY,EAAE,KAAK;;;EAGnB,cAAc,EAAE,KAAK;EACrB,mBAAmB,EAAE,KAAK;EAC1B,2BAA2B,EAAE,KAAK;;;EAGlC,UAAU,EAAE,CAAC;EACb,SAAS,EAAE,CAAC;EACZ,eAAe,EAAE,GAAG;EACpB,yBAAyB,EAAE,GAAG;EAC9B,eAAe,EAAE,GAAG;EACpB,yBAAyB,EAAE,GAAG;EAC9B,eAAe,EAAE,GAAG;EACpB,yBAAyB,EAAE,GAAG;EAC9B,eAAe,EAAE,GAAG;EACpB,yBAAyB,EAAE,GAAG;EAC9B,oBAAoB,EAAE,KAAK;EAC3B,8BAA8B,EAAE,KAAK;EACrC,oBAAoB,EAAE,KAAK;EAC3B,8BAA8B,EAAE,KAAK;EACrC,wBAAwB,EAAE,GAAG;;;EAG7B,eAAe,EAAE,IAAI;EACrB,eAAe,EAAE,CAAC;EAClB,kBAAkB,EAAE,IAAI;EACxB,eAAe,EAAE,IAAI;EACrB,oBAAoB,EAAE,KAAK;EAC3B,eAAe,EAAE,IAAI;EACrB,oBAAoB,EAAE,KAAK;EAC3B,iBAAiB,EAAE,IAAI;;;EAGvB,SAAS,EAAE,CAAC;EACZ,UAAU,EAAE,IAAI;EAChB,SAAS,EAAE,IAAI;EACf,mBAAmB,EAAE,IAAI;;;EAGzB,SAAS,EAAE,CAAC;EACZ,QAAQ,EAAE,CAAC;EACX,YAAY,EAAE,CAAC;EACf,aAAa,EAAE,CAAC;EAChB,YAAY,EAAE,CAAC;EACf,iBAAiB,EAAE,CAAC;EACpB,eAAe,EAAE,CAAC;CACnB,CAAC;;;;;;AAMF,AAAO,SAAS,aAAa,CAAC,QAAQ,EAAE;EACtC,IAAI,QAAQ,KAAK,KAAK,CAAC,cAAc,EAAE;IACrC,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,eAAe,EAAE;IAC7C,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,eAAe,EAAE;IAC7C,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,gBAAgB,EAAE;IAC9C,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,eAAe,EAAE;IAC7C,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,gBAAgB,EAAE;IAC9C,OAAO,CAAC,CAAC;GACV,MAAM,IAAI,QAAQ,KAAK,KAAK,CAAC,iBAAiB,EAAE;IAC/C,OAAO,CAAC,CAAC;GACV;;EAED,OAAO,CAAC,IAAI,EAAC,qBAAoB,GAAE,QAAQ,EAAG,CAAC;EAC/C,OAAO,CAAC,CAAC;CACV;;;;;;;;AAQD,AAAO,SAAS,QAAQ,CAAC,EAAE,EAAE,MAAM,EAAE,SAAc,EAAE;uCAAP,GAAG,CAAC,CAAC;;EACjDC,IAAI,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EAC5C,IAAI,MAAM,KAAK,SAAS,EAAE;IACxB,OAAO,CAAC,IAAI,EAAC,kBAAiB,GAAE,MAAM,EAAG,CAAC;IAC1C,OAAO,SAAS,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,MAAM,GAAG,EAAE,CAAC,oBAAoB,CAAC;GAC/D;;EAED,OAAO,MAAM,CAAC;CACf;;;;;;AAMD,AAAO,SAAS,YAAY,CAAC,GAAG,EAAE;EAChCA,IAAI,MAAM,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC;EAChC,IAAI,MAAM,KAAK,SAAS,EAAE;IACxB,OAAO,CAAC,IAAI,EAAC,uBAAsB,GAAE,GAAG,EAAG,CAAC;IAC5C,OAAO,aAAa,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;GAC/C;;EAED,OAAO,MAAM,CAAC;;;;;;;ACxUhB,IAAqB,YAAY,GAAC,qBAYrB,CAAC,KAAK,EAAE;;;EACnB,IAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;EACrB,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;EACtB,IAAM,CAAC,MAAM,GAAG,CAAC,CAAC;;EAElB,IAAM,MAAM,GAAG,CAAC,CAAC;EACjB,KAAOA,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC,EAAE;IAClD,IAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACtB,IAAM,EAAE,GAAG;MACT,IAAM,EAAE,IAAI,CAAC,IAAI;MACjB,MAAQ,EAAE,MAAM;MAChB,MAAQ,EAAE,CAAC;MACX,MAAQ,EAAE,CAAC,CAAC;MACZ,IAAM,EAAE,IAAI,CAAC,IAAI;MACjB,GAAK,EAAE,IAAI,CAAC,GAAG;MACf,SAAW,EAAE,CAAC,IAAI,CAAC,SAAS,KAAK,SAAS,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS;MACpE,KAAO,EAAE,IAAI,CAAC,GAAG,GAAG,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC;KAC3C,CAAC;;IAEJ,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;IAC9B,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;;IAE1B,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC,KAAK,CAAC;IAC1B,MAAQ,IAAI,EAAE,CAAC,KAAK,CAAC;GACpB;;EAEH,KAAOA,IAAIC,GAAC,GAAG,CAAC,EAAEC,KAAG,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAED,GAAC,GAAGC,KAAG,EAAE,EAAED,GAAC,EAAE;IAC3D,IAAME,IAAE,GAAGC,MAAI,CAAC,SAAS,CAACH,GAAC,CAAC,CAAC;IAC7B,IAAI,CAAC,MAAM,GAAGG,MAAI,CAAC,MAAM,CAAC;GACzB;CACF,CAAA;;;;;;AAMH,uBAAE,OAAO,qBAAC,QAAQ,EAAE;EAClB,OAAS,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;CAChC,CAAA;;ACtDH,IAAqB,WAAW,GAAC,oBAUpB,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE;EAC9D,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC;EACtB,IAAM,CAAC,QAAQ,GAAG,OAAO,CAAC;EAC1B,IAAM,CAAC,WAAW,GAAG,UAAU,CAAC;;;EAGhC,IAAM,KAAK,GAAG,CAAC,CAAC;EAChB,IAAM,MAAM,KAAK,KAAK,CAAC,eAAe,EAAE;IACtC,KAAO,GAAG,UAAU,CAAC;GACpB,MAAM,IAAI,MAAM,KAAK,KAAK,CAAC,gBAAgB,EAAE;IAC9C,KAAO,GAAG,CAAC,GAAG,UAAU,CAAC;GACxB,MAAM,IAAI,MAAM,KAAK,KAAK,CAAC,gBAAgB,EAAE;IAC9C,KAAO,GAAG,CAAC,GAAG,UAAU,CAAC;GACxB;EACH,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC;;;EAGtB,IAAM,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;EACzC,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;EACpB,IAAM,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;;;EAGvB,MAAQ,CAAC,MAAM,CAAC,EAAE,IAAI,KAAK,CAAC;CAC3B;;uCAAA;;;;;AAKH,sBAAE,OAAO,uBAAG;EACV,IAAM,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;IACvB,OAAS,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC;IAChD,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;EAC1B,EAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC9B,IAAM,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC;;EAEtC,IAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;CACjB,CAAA;;;;;;;AAOH,sBAAE,MAAM,oBAAC,MAAM,EAAE,IAAI,EAAE;EACrB,IAAM,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;IACvB,OAAS,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC3C,OAAS;GACR;;EAEH,IAAM,IAAI,IAAI,IAAI,CAAC,UAAU,GAAG,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE;IACpD,OAAS,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;IACxD,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;EAC5B,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;;EAE5B,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;EACrD,IAAM,CAAC,IAAI,EAAE;IACX,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;GAC9D,MAAM;IACP,IAAM,MAAM,EAAE;MACZ,EAAI,CAAC,aAAa,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC1D,MAAM;MACP,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KACvD;GACF;EACH,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;;;EAG/C,IAAM,IAAI,CAAC,QAAQ,EAAE;IACnB,IAAM,IAAI,CAAC,KAAK,EAAE;MAChB,IAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;KAC9B,MAAM;MACP,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;KACnB;GACF;CACF,CAAA;;AAEH,mBAAE,KAAS,mBAAI;EACb,OAAS,IAAI,CAAC,WAAW,CAAC;CACzB,CAAA;;;;AClGY,IAAM,YAAY,GAAC,qBAUrB,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,WAAW,EAAE,OAAO,EAAE;EAC/D,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC;EACtB,IAAM,CAAC,QAAQ,GAAG,OAAO,CAAC;EAC1B,IAAM,CAAC,YAAY,GAAG,WAAW,CAAC;;;EAGlC,IAAM,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC;;;EAGlD,IAAM,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;EACzC,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;EACpB,IAAM,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;;;EAGvB,MAAQ,CAAC,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC;CACjC;;yCAAA;;;;;AAKH,uBAAE,OAAO,uBAAG;EACV,IAAM,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;IACvB,OAAS,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC;IAChD,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;EAC1B,EAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC9B,IAAM,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC;;EAEtC,IAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;CACjB,CAAA;;;;;;;AAOH,uBAAE,MAAM,oBAAC,MAAM,EAAE,IAAI,EAAE;EACrB,IAAM,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;IACvB,OAAS,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC3C,OAAS;GACR;;EAEH,IAAM,IAAI,IAAI,IAAI,CAAC,UAAU,GAAG,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE;IACpD,OAAS,CAAC,KAAK,CAAC,sCAAsC,CAAC,CAAC;IACxD,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;EAC5B,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;;EAE5B,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;EAC7C,IAAM,CAAC,IAAI,EAAE;IACX,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;GACtD,MAAM;IACP,IAAM,MAAM,EAAE;MACZ,EAAI,CAAC,aAAa,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAClD,MAAM;MACP,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;KAC/C;GACF;EACH,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;;;EAGvC,IAAM,IAAI,CAAC,QAAQ,EAAE;IACnB,IAAM,IAAI,CAAC,KAAK,EAAE;MAChB,IAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;KAC9B,MAAM;MACP,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;KACnB;GACF;CACF,CAAA;;AAEHC,qBAAE,KAAS,mBAAI;EACb,OAAS,IAAI,CAAC,YAAY,CAAC;CAC1B,CAAA;;;;ACxFHL,IAAI,MAAM,GAAG,CAAC,CAAC;;AAEf,SAAS,WAAW,CAAC,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE;EACxC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG,EAAC;IAC/B,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;MAClB,OAAO;KACR;;IAEDA,IAAI,KAAK,GAAG,mCAAmC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1D,IAAI,KAAK,EAAE;MACT,GAAG,CAAC,IAAI,CAAC;QACP,IAAI,EAAE,IAAI;QACV,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;QACpB,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;QAClB,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;OACzB,CAAC,CAAC;KACJ,MAAM,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;MACzB,GAAG,CAAC,IAAI,CAAC;QACP,IAAI,EAAE,IAAI;QACV,MAAM,EAAE,CAAC,CAAC;QACV,IAAI,EAAE,CAAC;QACP,OAAO,EAAE,GAAG;OACb,CAAC,CAAC;KACJ;GACF,CAAC,CAAC;CACJ;;AAED,IAAqB,OAAO,GAAC,gBAsBhB,CAAC,MAAM,EAAE,OAAO,EAAE;EAC7B,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;;;EAGxB,IAAM,CAAC,WAAW,GAAG,EAAE,CAAC;EACxB,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;EACtB,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;EACtB,IAAM,CAAC,OAAO,GAAG,EAAE,CAAC;EACpB,IAAM,CAAC,OAAO,GAAG,KAAK,CAAC;EACvB,IAAM,CAAC,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC;EAClC,IAAM,CAAC,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC;EAClC,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;EACpB,IAAM,CAAC,GAAG,GAAG,MAAM,EAAE,CAAC;CACrB;;sCAAA;;AAEHK,qBAAE,EAAM,mBAAG;EACT,OAAS,IAAI,CAAC,GAAG,CAAC;CACjB,CAAA;;AAEH,kBAAE,IAAI,oBAAG;;;EACP,IAAM,IAAI,CAAC,OAAO,EAAE;IAClB,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;;EAE5B,IAAM,UAAU,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;EACzE,IAAM,UAAU,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,CAAC,eAAe,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;;EAE3E,IAAM,OAAO,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;EACnC,EAAI,CAAC,YAAY,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;EACvC,EAAI,CAAC,YAAY,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;EACvC,EAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;;EAE1B,IAAM,MAAM,GAAG,KAAK,CAAC;EACrB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;;EAE5B,IAAM,CAAC,EAAE,CAAC,kBAAkB,CAAC,UAAU,EAAE,EAAE,CAAC,cAAc,CAAC,EAAE;IAC3D,WAAa,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC;IAC7D,MAAQ,GAAG,IAAI,CAAC;GACf;;EAEH,IAAM,CAAC,EAAE,CAAC,kBAAkB,CAAC,UAAU,EAAE,EAAE,CAAC,cAAc,CAAC,EAAE;IAC3D,WAAa,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC;IAC7D,MAAQ,GAAG,IAAI,CAAC;GACf;;EAEH,EAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;EAC9B,EAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;;EAE9B,IAAM,MAAM,EAAE;IACZ,MAAQ,CAAC,OAAO,CAAC,UAAA,GAAG,EAAC;MACnB,OAAS,CAAC,KAAK,EAAC,oBAAmB,IAAE,GAAG,CAAC,IAAI,CAAA,MAAE,IAAE,GAAG,CAAC,MAAM,CAAA,UAAM,IAAE,GAAG,CAAC,IAAI,CAAA,QAAI,IAAE,GAAG,CAAC,OAAO,CAAA,EAAG,CAAC;KAC/F,CAAC,CAAC;IACL,OAAS;GACR;;EAEH,IAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,CAAC,WAAW,CAAC,EAAE;IACtD,OAAS,CAAC,KAAK,EAAC,iCAAgC,IAAE,EAAE,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAA,EAAG,CAAC;IACnF,MAAQ,GAAG,IAAI,CAAC;GACf;;EAEH,IAAM,MAAM,EAAE;IACZ,OAAS;GACR;;EAEH,IAAM,CAAC,KAAK,GAAG,OAAO,CAAC;;;EAGvB,IAAM,aAAa,GAAG,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,CAAC,iBAAiB,CAAC,CAAC;EAC5E,KAAOL,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,EAAE,EAAE,CAAC,EAAE;IACxC,IAAM,IAAI,GAAG,EAAE,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IAC5C,IAAM,QAAQ,GAAG,EAAE,CAAC,iBAAiB,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;;IAE1D,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC;MACtB,IAAM,EAAE,IAAI,CAAC,IAAI;MACjB,QAAU,EAAE,QAAQ;MACpB,IAAM,EAAE,IAAI,CAAC,IAAI;KAChB,CAAC,CAAC;GACJ;;;EAGH,IAAM,WAAW,GAAG,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,EAAE,CAAC,eAAe,CAAC,CAAC;EACxE,KAAOA,IAAIC,GAAC,GAAG,CAAC,EAAEA,GAAC,GAAG,WAAW,EAAE,EAAEA,GAAC,EAAE;IACtC,IAAMK,MAAI,GAAG,EAAE,CAAC,gBAAgB,CAAC,OAAO,EAAEL,GAAC,CAAC,CAAC;IAC7C,IAAM,IAAI,GAAGK,MAAI,CAAC,IAAI,CAAC;IACvB,IAAMC,UAAQ,GAAG,EAAE,CAAC,kBAAkB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACtD,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,KAAK,CAAC;IACvD,IAAM,OAAO,EAAE;MACb,IAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;KACxC;;IAEH,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC;MACpB,IAAM,EAAE,IAAI;MACZ,QAAU,EAAEA,UAAQ;MACpB,IAAM,EAAED,MAAI,CAAC,IAAI;MACjB,IAAM,EAAE,OAAO,GAAGA,MAAI,CAAC,IAAI,GAAG,SAAS;KACtC,CAAC,CAAC;GACJ;;EAEH,IAAM,CAAC,OAAO,GAAG,IAAI,CAAC;CACrB,CAAA;;AAEH,kBAAE,OAAO,uBAAG;EACV,IAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;EAC5B,EAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;EAE/B,IAAM,CAAC,OAAO,GAAG,KAAK,CAAC;EACvB,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;EACpB,IAAM,CAAC,WAAW,GAAG,EAAE,CAAC;EACxB,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;EACtB,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;CACrB,CAAA;;mEACF;;;;;;AAMD,SAAS,aAAa,CAAC,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE;EACpCN,IAAI,MAAM,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;EACnC,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;EAC7B,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;;EAEzB,OAAO,MAAM,CAAC;;;AC3KhB,IAAqB,OAAO,GAAC,gBAIhB,CAAC,MAAM,EAAE;EACpB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;;EAExB,IAAM,CAAC,MAAM,GAAG,CAAC,CAAC;EAClB,IAAM,CAAC,OAAO,GAAG,CAAC,CAAC;EACnB,IAAM,CAAC,UAAU,GAAG,KAAK,CAAC;EAC1B,IAAM,CAAC,WAAW,GAAG,KAAK,CAAC;;EAE3B,IAAM,CAAC,WAAW,GAAG,CAAC,CAAC;EACvB,IAAM,CAAC,UAAU,GAAG,KAAK,CAAC,aAAa,CAAC;EACxC,IAAM,CAAC,UAAU,GAAG,KAAK,CAAC,aAAa,CAAC;EACxC,IAAM,CAAC,UAAU,GAAG,KAAK,CAAC,aAAa,CAAC;EACxC,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC;EAClC,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC;;;EAGlC,IAAM,CAAC,OAAO,GAAG,KAAK,CAAC,iBAAiB,CAAC;;EAEzC,IAAM,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;CACnB,CAAA;;;;;AAKH,kBAAE,OAAO,uBAAG;EACV,IAAM,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,EAAE;IACvB,OAAS,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;IACjD,OAAS;GACR;;EAEH,IAAM,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;EAC1B,EAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;EAE/B,IAAM,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC;EACvC,IAAM,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;CACjB,CAAA;;ACtCH,SAAS,OAAO,CAAC,CAAC,EAAE;EAClB,OAAO,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;CAChC;;AAED,IAAqB,SAAS;EAAiB,kBAmBlC,CAAC,MAAM,EAAE,OAAO,EAAE;IAC3BQ,UAAK,KAAA,CAAC,MAAA,MAAM,CAAC,CAAC;IACd,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;;IAE3C,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;GACtB;;;;8CAAA;;;;;;;;;;;;;;;;;;;EAmBD,oBAAA,MAAM,oBAAC,OAAO,EAAE;IACdR,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC;;IAEhC,IAAI,OAAO,EAAE;MACX,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;MACD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;OAC/B;MACD,IAAI,OAAO,CAAC,UAAU,KAAK,SAAS,EAAE;QACpC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC;OACvC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;MACD,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;MACD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;QAC9B,IAAI,CAAC,WAAW;UACd,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,oBAAoB;UAC1C,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,6BAA6B;SACpD,CAAC;OACH;;;MAGD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC;QACjC,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC;OAC5B;;MAED,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;UAC7B,SAAS,GAAG,KAAK,CAAC;SACnB;OACF;KACF;;IAED,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;;IAEhC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;;IAE1CA,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC;IACtC,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC;IACjE,IAAI,CAAC,WAAW,EAAE,CAAC;;IAEnB,IAAI,SAAS,EAAE;MACb,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;MAC5C,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;KAClC;IACD,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;;;;;;;;;;;;;EAcD,oBAAA,cAAc,4BAAC,OAAO,EAAE;IACtBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;IAEvC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1C,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAClC,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;;;;;;;;;;;EAYD,oBAAA,WAAW,yBAAC,OAAO,EAAE;IACnBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;IAEvC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1C,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAC/B,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;EAED,oBAAA,YAAY,0BAAC,KAAK,EAAE,OAAO,EAAE;IAC3BA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC1BA,IAAI,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAC;IAChDA,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC;;IAExB;MACE,GAAG,YAAY,iBAAiB;MAChC,GAAG,YAAY,gBAAgB;MAC/B,GAAG,YAAY,gBAAgB;MAC/B;MACA,IAAI,KAAK,KAAK,SAAS,EAAE;QACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;OAC9C,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C;;MAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;QAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;OAC1D,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;OACrE;;MAED,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;KAC1G,MAAM;MACL,IAAI,KAAK,KAAK,SAAS,EAAE;QACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C;;MAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;QAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;OAC1D,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;OACrE;;MAED,IAAI,IAAI,CAAC,WAAW,EAAE;QACpB,EAAE,CAAC,uBAAuB,CAAC,EAAE,CAAC,UAAU;UACtC,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,KAAK,CAAC,MAAM;UACZ,GAAG;SACJ,CAAC;OACH,MAAM;QACL,EAAE,CAAC,aAAa;UACd,EAAE,CAAC,UAAU;UACb,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,KAAK,CAAC,MAAM;UACZ,KAAK,CAAC,SAAS;UACf,GAAG;SACJ,CAAC;OACH;KACF;GACF,CAAA;;EAED,oBAAA,SAAS,uBAAC,KAAK,EAAE,OAAO,EAAE;IACxBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC1BA,IAAI,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAC;IAChDA,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC;;IAExB;MACE,GAAG,YAAY,iBAAiB;MAChC,GAAG,YAAY,gBAAgB;MAC/B,GAAG,YAAY,gBAAgB;MAC/B;MACA,IAAI,KAAK,KAAK,SAAS,EAAE;QACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;OAC9C,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C;;MAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;QAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;OAC1D,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;OACrE;;MAED,EAAE,CAAC,UAAU;QACX,EAAE,CAAC,UAAU;QACb,OAAO,CAAC,KAAK;QACb,KAAK,CAAC,cAAc;QACpB,KAAK,CAAC,MAAM;QACZ,KAAK,CAAC,SAAS;QACf,GAAG;OACJ,CAAC;KACH,MAAM;MACL,IAAI,KAAK,KAAK,SAAS,EAAE;QACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;OAC/C;;MAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;QAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;OAC1D,MAAM;QACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;OACrE;;MAED,IAAI,IAAI,CAAC,WAAW,EAAE;QACpB,EAAE,CAAC,oBAAoB;UACrB,EAAE,CAAC,UAAU;UACb,OAAO,CAAC,KAAK;UACb,KAAK,CAAC,cAAc;UACpB,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,CAAC;UACD,GAAG;SACJ,CAAC;OACH,MAAM;QACL,EAAE,CAAC,UAAU;UACX,EAAE,CAAC,UAAU;UACb,OAAO,CAAC,KAAK;UACb,KAAK,CAAC,cAAc;UACpB,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,CAAC;UACD,KAAK,CAAC,MAAM;UACZ,KAAK,CAAC,SAAS;UACf,GAAG;SACJ,CAAC;OACH;KACF;GACF,CAAA;;EAED,oBAAA,UAAU,wBAAC,MAAM,EAAE,KAAK,EAAE,gBAAgB,EAAE;;;IAC1CA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACvCA,IAAI,OAAO,GAAG;MACZ,KAAK,EAAE,IAAI,CAAC,MAAM;MAClB,MAAM,EAAE,IAAI,CAAC,OAAO;MACpB,KAAK,EAAE,KAAK;MACZ,gBAAgB,EAAE,gBAAgB;MAClC,KAAK,EAAE,CAAC;MACR,KAAK,EAAE,IAAI;KACZ,CAAC;;IAEF,KAAKA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;MACtC,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC;MAClB,OAAO,CAAC,KAAK,GAAGI,MAAI,CAAC,MAAM,IAAI,CAAC,CAAC;MACjC,OAAO,CAAC,MAAM,GAAGA,MAAI,CAAC,OAAO,IAAI,CAAC,CAAC;MACnC,OAAO,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;MAC1BA,MAAI,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;KAChC;GACF,CAAA;;EAED,oBAAA,WAAW,2BAAG;IACZJ,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;;IAGxD,IAAI,CAAC,GAAG,KAAK,IAAI,CAAC,MAAM,KAAK,KAAK,CAAC,UAAU,IAAI,IAAI,CAAC,MAAM,KAAK,KAAK,CAAC,UAAU,CAAC,EAAE;MAClF,OAAO,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;MAC1E,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,UAAU,CAAC;MAC/B,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,UAAU,CAAC;KAChC;;IAED,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,kBAAkB,EAAE,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9H,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,kBAAkB,EAAE,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1F,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IAChE,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;;IAEhEA,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;IAC7D,IAAI,GAAG,EAAE;MACP,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KACnF;GACF,CAAA;;;EApUoC;;ACJvC,IAAqB,WAAW;EAAiB,oBAoBpC,CAAC,MAAM,EAAE,OAAO,EAAE;IAC3BQ,UAAK,KAAA,CAAC,MAAA,MAAM,CAAC,CAAC;IACd,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC;;IAEjD,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;GACtB;;;;kDAAA;;;;;;;;;;;;;;;;;;;;EAoBD,sBAAA,MAAM,oBAAC,OAAO,EAAE;IACdR,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC;;IAEhC,IAAI,OAAO,EAAE;MACX,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;MACD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;OAC/B;MACD,IAAI,OAAO,CAAC,UAAU,KAAK,SAAS,EAAE;QACpC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC;OACvC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC;OACrC;MACD,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;MACD,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;OAC7B;;;;;MAKD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;QAC9B,IAAI,CAAC,WAAW;UACd,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,oBAAoB;UAC1C,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,6BAA6B;SACpD,CAAC;OACH;;;MAGD,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC;QACjC,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC;OAC5B;;MAED,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;UAC7B,SAAS,GAAG,KAAK,CAAC;SACnB;OACF;KACF;;IAED,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;;IAEhC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;MAC9C,IAAI,OAAO,CAAC,MAAM,KAAK,SAAS,EAAE;QAChC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC;OAC1E;;MAED,IAAI,CAAC,WAAW,EAAE,CAAC;;MAEnB,IAAI,SAAS,EAAE;QACb,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;QAC5C,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,gBAAgB,CAAC,CAAC;OACxC;IACH,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;;;;;;;;;;;;;;EAeD,sBAAA,cAAc,4BAAC,OAAO,EAAE;IACtBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;IAEvC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAChD,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAClC,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;;;;;;;;;;;;EAaD,sBAAA,WAAW,yBAAC,OAAO,EAAE;IACnBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;IAEvC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;IAC9B,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAChD,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAC/B,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GACjC,CAAA;;EAED,sBAAA,YAAY,0BAAC,KAAK,EAAE,OAAO,EAAE;IAC3BA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC1BA,IAAI,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAC;IAChDA,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;IAClCA,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC;;IAExB,IAAI,KAAK,KAAK,SAAS,EAAE;MACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;KAC/C,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;KAC/C;;IAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;MAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;KAC1D,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;KACrE;;IAED;MACE,GAAG,YAAY,iBAAiB;MAChC,GAAG,YAAY,gBAAgB;MAC/B,GAAG,YAAY,gBAAgB;MAC/B;MACA,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,2BAA2B,GAAG,SAAS,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;KACvI,MAAM;MACL,IAAI,IAAI,CAAC,WAAW,EAAE;QACpB,EAAE,CAAC,uBAAuB,CAAC,EAAE,CAAC,2BAA2B,GAAG,SAAS;UACnE,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,KAAK,CAAC,MAAM;UACZ,GAAG;SACJ,CAAC;OACH,MAAM;QACL,EAAE,CAAC,aAAa;UACd,EAAE,CAAC,2BAA2B,GAAG,SAAS;UAC1C,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,CAAC;UACT,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,KAAK,CAAC,MAAM;UACZ,KAAK,CAAC,SAAS;UACf,GAAG;SACJ,CAAC;OACH;KACF;GACF,CAAA;;EAED,sBAAA,SAAS,uBAAC,KAAK,EAAE,OAAO,EAAE;IACxBA,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;IAC1BA,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC1BA,IAAI,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAC;IAChDA,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;IAClCA,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC;;IAExB,IAAI,KAAK,KAAK,SAAS,EAAE;MACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;KAC/C,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;KAC/C;;IAED,IAAI,gBAAgB,KAAK,SAAS,EAAE;MAClC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;KAC1D,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,8BAA8B,EAAE,gBAAgB,CAAC,CAAC;KACrE;IACD;MACE,GAAG,YAAY,iBAAiB;MAChC,GAAG,YAAY,gBAAgB;MAC/B,GAAG,YAAY,gBAAgB;MAC/B;MACA,EAAE,CAAC,UAAU;QACX,EAAE,CAAC,2BAA2B,GAAG,SAAS;QAC1C,OAAO,CAAC,KAAK;QACb,KAAK,CAAC,cAAc;QACpB,KAAK,CAAC,MAAM;QACZ,KAAK,CAAC,SAAS;QACf,GAAG;OACJ,CAAC;KACH,MAAM;MACL,IAAI,IAAI,CAAC,WAAW,EAAE;QACpB,EAAE,CAAC,oBAAoB;UACrB,EAAE,CAAC,2BAA2B,GAAG,SAAS;UAC1C,OAAO,CAAC,KAAK;UACb,KAAK,CAAC,cAAc;UACpB,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,CAAC;UACD,GAAG;SACJ,CAAC;OACH,MAAM;QACL,EAAE,CAAC,UAAU;UACX,EAAE,CAAC,2BAA2B,GAAG,SAAS;UAC1C,OAAO,CAAC,KAAK;UACb,KAAK,CAAC,cAAc;UACpB,OAAO,CAAC,KAAK;UACb,OAAO,CAAC,MAAM;UACd,CAAC;UACD,KAAK,CAAC,MAAM;UACZ,KAAK,CAAC,SAAS;UACf,GAAG;SACJ,CAAC;OACH;KACF;GACF,CAAA;;;;EAID,sBAAA,UAAU,wBAAC,MAAM,EAAE,KAAK,EAAE,gBAAgB,EAAE;;;IAC1CA,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACvCA,IAAI,OAAO,GAAG;MACZ,KAAK,EAAE,IAAI,CAAC,MAAM;MAClB,MAAM,EAAE,IAAI,CAAC,OAAO;MACpB,SAAS,GAAG,CAAC;MACb,KAAK,EAAE,KAAK;MACZ,gBAAgB,EAAE,gBAAgB;MAClC,KAAK,EAAE,CAAC;MACR,KAAK,EAAE,IAAI;KACZ,CAAC;;IAEF,KAAKA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;MACtCA,IAAI,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;MAC5B,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC;MAClB,OAAO,CAAC,KAAK,GAAGI,MAAI,CAAC,MAAM,IAAI,CAAC,CAAC;MACjC,OAAO,CAAC,MAAM,GAAGA,MAAI,CAAC,OAAO,IAAI,CAAC,CAAC;;MAEnC,KAAKJ,IAAI,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,CAAC,EAAE,EAAE,IAAI,EAAE;QACnC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;QACzB,OAAO,CAAC,KAAK,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;QAClCI,MAAI,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;OAChC;KACF;GACF,CAAA;;EAED,sBAAA,WAAW,2BAAG;IACZJ,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;;IAE1B,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,gBAAgB,EAAE,EAAE,CAAC,kBAAkB,EAAE,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACpI,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,gBAAgB,EAAE,EAAE,CAAC,kBAAkB,EAAE,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAChG,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,gBAAgB,EAAE,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IACtE,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,gBAAgB,EAAE,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;;;;IAItEA,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;IAC7D,IAAI,GAAG,EAAE;MACP,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,gBAAgB,EAAE,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KACzF;GACF,CAAA;;;EAxTsC,OAyTxC,GAAA;;AC5Tc,IAAM,YAAY,GAAC,qBAQrB,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;EAC3C,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC;EACtB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;;EAExB,IAAQ,EAAE,GAAG,MAAM,CAAC,GAAG,CAAC;EACxB,IAAM,CAAC,KAAK,GAAG,EAAE,CAAC,kBAAkB,EAAE,CAAC;;EAEvC,EAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;EACnD,EAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,YAAY,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;EACjE,EAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;CAC5C,CAAA;;;;;AAKH,uBAAE,OAAO,uBAAG;EACV,IAAM,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;IACzB,OAAS,CAAC,KAAK,CAAC,qCAAqC,CAAC,CAAC;IACvD,OAAS;GACR;;EAEH,IAAQ,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;;EAE9B,EAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;EAC7C,EAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;EAEpC,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;CACnB,CAAA;;ACrCY,IAAM,WAAW,GAAC,oBAYpB,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;EAC5C,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;EACxB,IAAM,CAAC,MAAM,GAAG,KAAK,CAAC;EACtB,IAAM,CAAC,OAAO,GAAG,MAAM,CAAC;;EAExB,IAAM,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC;EACtC,IAAM,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC;EACtC,IAAM,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC;EAC1C,IAAM,CAAC,aAAa,GAAG,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC;;EAEpD,IAAM,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC;CAC7C,CAAA;;;;;AAKH,sBAAE,OAAO,uBAAG;EACV,IAAM,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;IACzB,OAAS,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;IACtD,OAAS;GACR;;EAEH,IAAQ,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;;EAE9B,EAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;EAEnC,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;CACnB,CAAA;;ACrCHD,IAAM,QAAQ,GAAG;;EAEf,KAAK,EAAE,KAAK;EACZ,QAAQ,EAAE,KAAK;EACf,UAAU,EAAE,UAAU;EACtB,OAAO,EAAE,KAAK,CAAC,cAAc;EAC7B,YAAY,EAAE,KAAK,CAAC,cAAc;EAClC,QAAQ,EAAE,KAAK,CAAC,SAAS;EACzB,QAAQ,EAAE,KAAK,CAAC,UAAU;EAC1B,aAAa,EAAE,KAAK,CAAC,SAAS;EAC9B,aAAa,EAAE,KAAK,CAAC,UAAU;;;EAG/B,SAAS,EAAE,KAAK;EAChB,UAAU,EAAE,KAAK;EACjB,SAAS,EAAE,KAAK,CAAC,YAAY;;;EAG7B,WAAW,EAAE,KAAK;EAClB,UAAU,EAAE,KAAK;EACjB,gBAAgB,EAAE,KAAK,CAAC,cAAc;EACtC,eAAe,EAAE,CAAC;EAClB,gBAAgB,EAAE,IAAI;EACtB,kBAAkB,EAAE,KAAK,CAAC,eAAe;EACzC,mBAAmB,EAAE,KAAK,CAAC,eAAe;EAC1C,mBAAmB,EAAE,KAAK,CAAC,eAAe;EAC1C,qBAAqB,EAAE,IAAI;EAC3B,eAAe,EAAE,KAAK,CAAC,cAAc;EACrC,cAAc,EAAE,CAAC;EACjB,eAAe,EAAE,IAAI;EACrB,iBAAiB,EAAE,KAAK,CAAC,eAAe;EACxC,kBAAkB,EAAE,KAAK,CAAC,eAAe;EACzC,kBAAkB,EAAE,KAAK,CAAC,eAAe;EACzC,oBAAoB,EAAE,IAAI;;;EAG1B,QAAQ,EAAE,KAAK,CAAC,SAAS;;;EAGzB,aAAa,EAAE,KAAK,CAAC,YAAY;;;EAGjC,SAAS,EAAE,CAAC,CAAC;EACb,aAAa,EAAE,EAAE;EACjB,mBAAmB,EAAE,EAAE;EACvB,WAAW,EAAE,IAAI;EACjB,YAAY,EAAE,EAAE;EAChB,OAAO,EAAE,IAAI;CACd,CAAC;;AAEF,IAAqB,KAAK,GAAC,cACd,GAAG;;EAEd,IAAM,CAAC,aAAa,GAAG,EAAE,CAAC;EAC1B,IAAM,CAAC,mBAAmB,GAAG,EAAE,CAAC;EAChC,IAAM,CAAC,YAAY,GAAG,EAAE,CAAC;;EAEzB,IAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;CACpB,CAAA;;AAEH,gBAAE,KAAK,qBAAI;EACT,IAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;CACpB,CAAA;;AAEH,gBAAE,GAAG,iBAAE,GAAG,EAAE;;;;EAEV,IAAM,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;EACzB,IAAM,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;EAC/B,IAAM,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;EACnC,IAAM,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;EAC7B,IAAM,CAAC,YAAY,GAAG,GAAG,CAAC,YAAY,CAAC;EACvC,IAAM,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;EAC/B,IAAM,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;EAC/B,IAAM,CAAC,aAAa,GAAG,GAAG,CAAC,aAAa,CAAC;EACzC,IAAM,CAAC,aAAa,GAAG,GAAG,CAAC,aAAa,CAAC;;;EAGzC,IAAM,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC;EACjC,IAAM,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;EACnC,IAAM,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC;;;EAGjC,IAAM,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAC;EACrC,IAAM,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;EACnC,IAAM,CAAC,gBAAgB,GAAG,GAAG,CAAC,gBAAgB,CAAC;EAC/C,IAAM,CAAC,eAAe,GAAG,GAAG,CAAC,eAAe,CAAC;EAC7C,IAAM,CAAC,gBAAgB,GAAG,GAAG,CAAC,gBAAgB,CAAC;EAC/C,IAAM,CAAC,kBAAkB,GAAG,GAAG,CAAC,kBAAkB,CAAC;EACnD,IAAM,CAAC,mBAAmB,GAAG,GAAG,CAAC,mBAAmB,CAAC;EACrD,IAAM,CAAC,mBAAmB,GAAG,GAAG,CAAC,mBAAmB,CAAC;EACrD,IAAM,CAAC,qBAAqB,GAAG,GAAG,CAAC,qBAAqB,CAAC;EACzD,IAAM,CAAC,eAAe,GAAG,GAAG,CAAC,eAAe,CAAC;EAC7C,IAAM,CAAC,cAAc,GAAG,GAAG,CAAC,cAAc,CAAC;EAC3C,IAAM,CAAC,eAAe,GAAG,GAAG,CAAC,eAAe,CAAC;EAC7C,IAAM,CAAC,iBAAiB,GAAG,GAAG,CAAC,iBAAiB,CAAC;EACjD,IAAM,CAAC,kBAAkB,GAAG,GAAG,CAAC,kBAAkB,CAAC;EACnD,IAAM,CAAC,kBAAkB,GAAG,GAAG,CAAC,kBAAkB,CAAC;EACnD,IAAM,CAAC,oBAAoB,GAAG,GAAG,CAAC,oBAAoB,CAAC;;;EAGvD,IAAM,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;;;EAG/B,IAAM,CAAC,aAAa,GAAG,GAAG,CAAC,aAAa,CAAC;;;EAGzC,IAAM,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC;EACjC,KAAOC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;IACnD,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;GAC9C;EACH,KAAOA,IAAIC,GAAC,GAAG,CAAC,EAAEA,GAAC,GAAG,GAAG,CAAC,mBAAmB,CAAC,MAAM,EAAE,EAAEA,GAAC,EAAE;IACzD,MAAM,CAAC,mBAAmB,CAACA,GAAC,CAAC,GAAG,GAAG,CAAC,mBAAmB,CAACA,GAAC,CAAC,CAAC;GAC1D;EACH,IAAM,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAC;EACrC,KAAOD,IAAIC,GAAC,GAAG,CAAC,EAAEA,GAAC,GAAG,GAAG,CAAC,YAAY,CAAC,MAAM,EAAE,EAAEA,GAAC,EAAE;IAClD,MAAM,CAAC,YAAY,CAACA,GAAC,CAAC,GAAG,GAAG,CAAC,YAAY,CAACA,GAAC,CAAC,CAAC;GAC5C;EACH,IAAM,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;CAC5B,CAAA;;AClHHF,IAAM,MAAM,GAAG,IAAI,CAAC;AACpBA,IAAMU,UAAQ,GAAG,IAAI,CAAC;AACtBV,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,WAAW,GAAG,KAAK,CAAC;AAC1BA,IAAM,WAAW,GAAG,KAAK,CAAC;AAC1BA,IAAM,WAAW,GAAG,KAAK,CAAC;AAC1BA,IAAM,OAAO,GAAG,KAAK,CAAC;AACtBA,IAAM,YAAY,GAAG,KAAK,CAAC;AAC3BA,IAAM,YAAY,GAAG,KAAK,CAAC;AAC3BA,IAAM,YAAY,GAAG,KAAK,CAAC;AAC3BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,aAAa,GAAG,KAAK,CAAC;AAC5BA,IAAM,eAAe,GAAG,KAAK,CAAC;;;;;AAK9BC,IAAI,mBAAmB,GAAG,EAAC;mBACzB,CAAC,MAAM,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACjC,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GACzB;mBAAC,CAEDS,UAAQ,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACnC,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GACzB;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,OAAO,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IAClC,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GACzB;mBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;mBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GACzB;mBAAC,CAED,eAAe,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IAC1C,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAE3B,CAAC;;;;;AAKFT,IAAI,wBAAwB,GAAG,EAAC;wBAC9B,CAAC,MAAM,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACjC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAEDS,UAAQ,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACnC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,WAAW,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,OAAO,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IAClC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,YAAY,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,gBAAgB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;GACvC;wBAAC,CAED,aAAa,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IACxC,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAC1B;wBAAC,CAED,eAAe,CAAC,GAAA,UAAY,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;IAC1C,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;GAE5B,CAAC;;;;;AAKF,SAAS,kBAAkB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;;EAEzC,IAAI,GAAG,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;IAC5B,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;MACf,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;MACrB,OAAO;KACR;;IAED,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;;IAEpB;MACE,IAAI,CAAC,QAAQ,KAAK,KAAK,CAAC,oBAAoB;MAC5C,IAAI,CAAC,QAAQ,KAAK,KAAK,CAAC,8BAA8B;MACtD,IAAI,CAAC,QAAQ,KAAK,KAAK,CAAC,oBAAoB;MAC5C,IAAI,CAAC,QAAQ,KAAK,KAAK,CAAC,8BAA8B;MACtD;MACA,EAAE,CAAC,UAAU;QACX,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,IAAI,GAAG;QAC7B,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,GAAG,IAAI,IAAI,GAAG;QACpC,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,GAAG,IAAI,IAAI,GAAG;QACnC,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,GAAG;OAC/B,CAAC;KACH;;IAED,IAAI,IAAI,CAAC,QAAQ,EAAE;MACjB,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;MAC3F,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;KAC3D,MAAM;MACL,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;MAC3C,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAChC;;IAED,OAAO;GACR;;;EAGD,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,EAAE;IACxB,OAAO;GACR;;;EAGD,IAAI,GAAG,CAAC,UAAU,KAAK,IAAI,CAAC,UAAU,EAAE;IACtC,EAAE,CAAC,UAAU;MACX,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,IAAI,GAAG;MAC7B,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,GAAG,IAAI,IAAI,GAAG;MACpC,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,GAAG,IAAI,IAAI,GAAG;MACnC,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,GAAG;KAC/B,CAAC;GACH;;;EAGD,IAAI,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ,EAAE;IAClC,IAAI,IAAI,CAAC,QAAQ,EAAE;MACjB,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;MAC3F,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;KAC3D,MAAM;MACL,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;MAC3C,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAChC;;IAED,OAAO;GACR;;EAED,IAAI,IAAI,CAAC,QAAQ,EAAE;;IAEjB;MACE,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ;MAC9B,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ;MAC9B,GAAG,CAAC,aAAa,KAAK,IAAI,CAAC,aAAa;MACxC,GAAG,CAAC,aAAa,KAAK,IAAI,CAAC,aAAa;MACxC;MACA,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;KAC5F;;;IAGD;MACE,GAAG,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO;MAC5B,GAAG,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY;MACtC;MACA,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;KAC3D;GACF,MAAM;;IAEL;MACE,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ;MAC9B,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ;MAC9B;MACA,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;KAC5C;;;IAGD,IAAI,GAAG,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE;MAChC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAChC;GACF;CACF;;;;;AAKD,SAAS,kBAAkB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;;EAEzC,IAAI,GAAG,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;IACpC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MACnB,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;MAC1B,OAAO;KACR;;IAED,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;IACzB,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAC7B,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;;IAE9B,OAAO;GACR;;;EAGD,IAAI,GAAG,CAAC,UAAU,KAAK,IAAI,CAAC,UAAU,EAAE;IACtC,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;GAC/B;;;EAGD,IAAI,IAAI,CAAC,SAAS,KAAK,KAAK,EAAE;IAC5B,IAAI,IAAI,CAAC,UAAU,EAAE;MACnB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;MACtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,cAAc,CAAC;;MAEtC,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;MACzB,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KAC9B;;IAED,OAAO;GACR;;;EAGD,IAAI,GAAG,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;IACpC,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;GAC9B;CACF;;;;;AAKD,SAAS,oBAAoB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;EAC3C,IAAI,IAAI,CAAC,WAAW,KAAK,GAAG,CAAC,WAAW,EAAE;IACxC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;MACrB,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC;MAC5B,OAAO;KACR;;IAED,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC;;IAE3B,IAAI,IAAI,CAAC,UAAU,EAAE;MACnB,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;MACrG,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;MAC7D,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;MAC5G,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;MACjG,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;MAC3D,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;KACzG,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;MACnF,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;MAC3C,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;KAC3F;;IAED,OAAO;GACR;;;EAGD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;IACrB,OAAO;GACR;;EAED,IAAI,GAAG,CAAC,UAAU,KAAK,IAAI,CAAC,UAAU,EAAE;IACtC,IAAI,IAAI,CAAC,UAAU,EAAE;MACnB,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;MACrG,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;MAC7D,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;MAC5G,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;MACjG,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;MAC3D,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;KACzG,MAAM;MACL,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;MACnF,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;MAC3C,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;KAC3F;IACD,OAAO;GACR;;EAED,IAAI,IAAI,CAAC,UAAU,EAAE;;IAEnB;MACE,GAAG,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB;MAC9C,GAAG,CAAC,eAAe,KAAK,IAAI,CAAC,eAAe;MAC5C,GAAG,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB;MAC9C;MACA,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;KACtG;IACD,IAAI,GAAG,CAAC,qBAAqB,KAAK,IAAI,CAAC,qBAAqB,EAAE;MAC5D,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;KAC9D;IACD;MACE,GAAG,CAAC,kBAAkB,KAAK,IAAI,CAAC,kBAAkB;MAClD,GAAG,CAAC,mBAAmB,KAAK,IAAI,CAAC,mBAAmB;MACpD,GAAG,CAAC,mBAAmB,KAAK,IAAI,CAAC,mBAAmB;MACpD;MACA,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;KAC7G;;;IAGD;MACE,GAAG,CAAC,eAAe,KAAK,IAAI,CAAC,eAAe;MAC5C,GAAG,CAAC,cAAc,KAAK,IAAI,CAAC,cAAc;MAC1C,GAAG,CAAC,eAAe,KAAK,IAAI,CAAC,eAAe;MAC5C;MACA,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;KAClG;IACD,IAAI,GAAG,CAAC,oBAAoB,KAAK,IAAI,CAAC,oBAAoB,EAAE;MAC1D,EAAE,CAAC,mBAAmB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;KAC5D;IACD;MACE,GAAG,CAAC,iBAAiB,KAAK,IAAI,CAAC,iBAAiB;MAChD,GAAG,CAAC,kBAAkB,KAAK,IAAI,CAAC,kBAAkB;MAClD,GAAG,CAAC,kBAAkB,KAAK,IAAI,CAAC,kBAAkB;MAClD;MACA,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;KACzG;GACF,MAAM;IACL;MACE,GAAG,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB;MAC9C,GAAG,CAAC,eAAe,KAAK,IAAI,CAAC,eAAe;MAC5C,GAAG,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB;MAC9C;MACA,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;KACpF;IACD,IAAI,GAAG,CAAC,qBAAqB,KAAK,IAAI,CAAC,qBAAqB,EAAE;MAC5D,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;KAC5C;IACD;MACE,GAAG,CAAC,kBAAkB,KAAK,IAAI,CAAC,kBAAkB;MAClD,GAAG,CAAC,mBAAmB,KAAK,IAAI,CAAC,mBAAmB;MACpD,GAAG,CAAC,mBAAmB,KAAK,IAAI,CAAC,mBAAmB;MACpD;MACA,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;KAC3F;GACF;;CAEF;;;;;AAKD,SAAS,eAAe,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;EACtC,IAAI,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,QAAQ,EAAE;IAClC,OAAO;GACR;;EAED,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,CAAC,SAAS,EAAE;IACrC,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;IACzB,OAAO;GACR;;EAED,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;EACxB,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;CAC5B;;;;;AAKD,SAAS,oBAAoB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;EAC3CT,IAAI,UAAU,GAAG,KAAK,CAAC;;;EAGvB,IAAI,IAAI,CAAC,SAAS,KAAK,CAAC,CAAC,EAAE;IACzB,OAAO,CAAC,IAAI,CAAC,2EAA2E,CAAC,CAAC;IAC1F,OAAO;GACR;;EAED,IAAI,GAAG,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;IACpC,UAAU,GAAG,IAAI,CAAC;GACnB,MAAM,IAAI,GAAG,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE;IACvC,UAAU,GAAG,IAAI,CAAC;GACnB,MAAM;IACL,KAAKA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;MAC3C;QACE,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;QAC9C,GAAG,CAAC,mBAAmB,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC;QAC1D;QACA,UAAU,GAAG,IAAI,CAAC;QAClB,MAAM;OACP;KACF;GACF;;EAED,IAAI,UAAU,EAAE;IACd,KAAKA,IAAIC,GAAC,GAAG,CAAC,EAAEA,GAAC,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,EAAE,EAAEA,GAAC,EAAE;MAC3CD,IAAI,EAAE,GAAG,IAAI,CAAC,aAAa,CAACC,GAAC,CAAC,CAAC;MAC/BD,IAAI,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAACC,GAAC,CAAC,CAAC;MAC3C,IAAI,CAAC,EAAE,EAAE;QACP,SAAS;OACV;;MAED,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;;MAEzC,KAAKD,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QACxDA,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;;QAEvCA,IAAI,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,EAAE,EAAE;UACP,OAAO,CAAC,IAAI,EAAC,iCAAgC,IAAE,IAAI,CAAC,IAAI,CAAA,EAAG,CAAC;UAC5D,SAAS;SACV;;QAED,EAAE,CAAC,uBAAuB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1C,EAAE,CAAC,mBAAmB;UACpB,IAAI,CAAC,QAAQ;UACb,EAAE,CAAC,GAAG;UACN,EAAE,CAAC,IAAI;UACP,EAAE,CAAC,SAAS;UACZ,EAAE,CAAC,MAAM;UACT,EAAE,CAAC,MAAM,GAAG,QAAQ,GAAG,EAAE,CAAC,MAAM;SACjC,CAAC;OACH;KACF;GACF;CACF;;;;;AAKD,SAAS,eAAe,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE;EACtC,KAAKA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;IACjD,IAAI,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE;MAChDA,IAAI,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;MACnC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;MAClC,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;KAChD;GACF;CACF;;;;;AAKD,SAAS,OAAO,CAAC,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAE,IAAQ,EAAE;6BAAN,GAAG,CAAC;;EACjD,IAAI,UAAU,YAAY,SAAS,EAAE;IACnC,EAAE,CAAC,oBAAoB;MACrB,EAAE,CAAC,WAAW;MACd,QAAQ;MACR,EAAE,CAAC,UAAU;MACb,UAAU,CAAC,KAAK;MAChB,CAAC;KACF,CAAC;GACH,MAAM,IAAI,UAAU,YAAY,WAAW,EAAE;IAC5C,EAAE,CAAC,oBAAoB;MACrB,EAAE,CAAC,WAAW;MACd,QAAQ;MACR,EAAE,CAAC,2BAA2B,GAAG,IAAI;MACrC,UAAU,CAAC,KAAK;MAChB,CAAC;KACF,CAAC;GACH,MAAM;IACL,EAAE,CAAC,uBAAuB;MACxB,EAAE,CAAC,WAAW;MACd,QAAQ;MACR,EAAE,CAAC,YAAY;MACf,UAAU,CAAC,KAAK;KACjB,CAAC;GACH;CACF;;AAED,IAAqB,MAAM,GAAC,eAKf,CAAC,QAAQ,EAAE,IAAI,EAAE;EAC5B,IAAM,EAAE,CAAC;;;EAGT,IAAM,GAAG,IAAI,IAAI,EAAE,CAAC;EACpB,IAAM,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;IAC9B,IAAM,CAAC,KAAK,GAAG,KAAK,CAAC;GACpB;EACH,IAAM,IAAI,CAAC,OAAO,KAAK,SAAS,EAAE;IAChC,IAAM,CAAC,OAAO,GAAG,IAAI,CAAC;GACrB;EACH,IAAM,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;IAC9B,IAAM,CAAC,KAAK,GAAG,IAAI,CAAC;GACnB;EACH,IAAM,IAAI,CAAC,SAAS,KAAK,SAAS,EAAE;IAClC,IAAM,CAAC,SAAS,GAAG,KAAK,CAAC;GACxB;;EAEH,IAAM,IAAI,CAAC,qBAAqB,KAAK,SAAS,EAAE;IAC9C,IAAM,CAAC,qBAAqB,GAAG,KAAK,CAAC;GACpC;;;EAGH,IAAM;IACJ,EAAI,GAAG,QAAQ,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;GACzC,CAAC,OAAO,GAAG,EAAE;IACd,OAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACrB,OAAS;GACR;;;EAGH,IAAM,CAAC,GAAG,GAAG,EAAE,CAAC;EAChB,IAAM,CAAC,WAAW,GAAG,EAAE,CAAC;EACxB,IAAM,CAAC,KAAK,GAAG,EAAE,CAAC;EAClB,IAAM,CAAC,MAAM,GAAG;IACd,OAAS,EAAE,CAAC;IACZ,EAAI,EAAE,CAAC;IACP,EAAI,EAAE,CAAC;IACP,SAAW,EAAE,CAAC;GACb,CAAC;;;EAGJ,IAAM,CAAC,QAAQ,GAAG,IAAI,KAAK,EAAE,CAAC;EAC9B,IAAM,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;EAC3B,IAAM,CAAC,SAAS,GAAG,EAAE,CAAC;EACtB,IAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;EAChD,IAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;EAChD,IAAM,CAAC,YAAY,GAAG,IAAI,CAAC;;EAE3B,IAAM,CAAC,eAAe,CAAC;IACrB,gCAAkC;IAClC,0BAA4B;IAC5B,mBAAqB;IACrB,0BAA4B;IAC5B,wBAA0B;IAC1B,+BAAiC;IACjC,yBAA2B;IAC3B,8BAAgC;IAChC,+BAAiC;IACjC,gCAAkC;IAClC,+BAAiC;IACjC,qBAAuB;IACvB,oBAAsB,EACrB,CAAC,CAAC;EACL,IAAM,CAAC,SAAS,EAAE,CAAC;EACnB,IAAM,CAAC,WAAW,EAAE,CAAC;CACpB,CAAA;;AAEH,iBAAE,eAAe,6BAAC,UAAU,EAAE;;;EAC5B,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;;EAEtB,KAAOA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;IAC5C,IAAM,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;;IAE3B,IAAM;MACJ,IAAM,GAAG,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;MAClC,IAAM,GAAG,EAAE;QACT,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;OAC9B;KACF,CAAC,OAAO,CAAC,EAAE;MACZ,OAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KAClB;GACF;CACF,CAAA;;AAEH,iBAAE,SAAS,yBAAG;EACZ,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;EACtB,IAAQ,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;;EAExD,IAAM,CAAC,KAAK,CAAC,iBAAiB,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,8BAA8B,CAAC,CAAC;EACpF,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,4BAA4B,CAAC,CAAC;EAChF,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAAC;;EAE3E,IAAM,CAAC,KAAK,CAAC,cAAc,GAAG,cAAc,GAAG,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,sBAAsB,CAAC,GAAG,CAAC,CAAC;EAC1G,IAAM,CAAC,KAAK,CAAC,mBAAmB,GAAG,cAAc,GAAG,EAAE,CAAC,YAAY,CAAC,cAAc,CAAC,2BAA2B,CAAC,GAAG,CAAC,CAAC;CACnH,CAAA;;AAEH,iBAAE,WAAW,2BAAG;EACd,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;;;EAGtB,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;EACvB,EAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC;EAChC,EAAI,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;EAChC,EAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEzB,EAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;;EAEvC,EAAI,CAAC,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;EAC1B,EAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;;EAEvB,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;EAC5B,EAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;EACxB,EAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EACtB,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,mBAAmB,CAAC,CAAC;EACrC,EAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;EAErB,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC;EAC9B,EAAI,CAAC,WAAW,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;EACrC,EAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;EACvB,EAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC;;;;;;;;EAQ1C,EAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;EACnB,EAAI,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EAC5B,EAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;;EAErB,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC;CAC7B,CAAA;;AAEH,iBAAE,eAAe,6BAAE,IAAI,EAAE;EACvB,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;;EAEtB,IAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;EACjD,IAAM,OAAO,EAAE;IACb,EAAI,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;GAChD,MAAM;IACP,EAAI,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;GACrC;CACF,CAAA;;;;;;AAMH,iBAAE,GAAG,iBAAC,IAAI,EAAE;EACV,OAAS,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;CAC/B,CAAA;;;;;;;;;;AAUH,iBAAE,cAAc,4BAAC,EAAE,EAAE;;;EACnB,IAAM,IAAI,CAAC,YAAY,KAAK,EAAE,EAAE;IAC9B,OAAS;GACR;;EAEH,IAAM,CAAC,YAAY,GAAG,EAAE,CAAC;EACzB,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;;EAEtB,IAAM,EAAE,KAAK,IAAI,EAAE;IACjB,EAAI,CAAC,eAAe,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAC3C,OAAS;GACR;;EAEH,EAAI,CAAC,eAAe,CAAC,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;;EAE/C,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC;EACnD,KAAOA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,EAAE,EAAE,CAAC,EAAE;IACpC,IAAM,WAAW,GAAGI,MAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACjD,OAAS,CAAC,EAAE,EAAE,EAAE,CAAC,iBAAiB,GAAG,CAAC,EAAE,WAAW,CAAC,CAAC;;;GAGpD;EACH,KAAOJ,IAAIC,GAAC,GAAG,SAAS,EAAEA,GAAC,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,EAAEA,GAAC,EAAE;IACjE,EAAI,CAAC,oBAAoB;MACvB,EAAI,CAAC,WAAW;MAChB,EAAI,CAAC,iBAAiB,GAAGA,GAAC;MAC1B,EAAI,CAAC,UAAU;MACf,IAAM;MACN,CAAG;KACF,CAAC;GACH;;EAEH,IAAM,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE;IAC9B,OAAS,CAAC,EAAE,EAAE,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;GAC5D;;EAEH,IAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE;IAChC,OAAS,CAAC,EAAE,EAAE,EAAE,CAAC,kBAAkB,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;GACjD;;EAEH,IAAM,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE;IACrC,OAAS,CAAC,EAAE,EAAE,EAAE,CAAC,wBAAwB,EAAE,EAAE,CAAC,aAAa,CAAC,CAAC;GAC5D;CACF,CAAA;;;;;;;;;AASH,iBAAE,WAAW,yBAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EACxB;IACE,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IACd;IACF,IAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAChC,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;GACd;CACF,CAAA;;;;;;;;;AASH,iBAAE,UAAU,wBAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EACvB;IACE,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IAChB,IAAM,CAAC,GAAG,KAAK,CAAC;IACd;IACF,IAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/B,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;IACf,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;GACd;CACF,CAAA;;;;;;;;;AASH,iBAAE,KAAK,mBAAC,IAAI,EAAE;EACZ,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;EACtB,IAAM,KAAK,GAAG,CAAC,CAAC;;EAEhB,IAAM,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;IAC9B,KAAO,IAAI,EAAE,CAAC,gBAAgB,CAAC;IAC/B,EAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;GAC3E;;EAEH,IAAM,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;IAC9B,KAAO,IAAI,EAAE,CAAC,gBAAgB,CAAC;IAC/B,EAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;IAE5B,EAAI,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;IAC3B,EAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IACrB,EAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;GACzB;;EAEH,IAAM,IAAI,CAAC,OAAO,KAAK,SAAS,EAAE;IAChC,KAAO,IAAI,EAAE,CAAC,kBAAkB,CAAC;IACjC,EAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;GAC/B;;EAEH,EAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;;;EAGlB,IAAM,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;IAC9B,IAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,KAAK,KAAK,EAAE;MACvC,EAAI,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;KAC3B,MAAM;MACP,IAAM,IAAI,CAAC,QAAQ,CAAC,UAAU,KAAK,KAAK,EAAE;QACxC,EAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;OACrB;MACH,IAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,KAAK,KAAK,CAAC,cAAc,EAAE;QACtD,EAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;OACvC;KACF;GACF;CACF,CAAA;;;;;;;;;AASH,iBAAE,WAAW,2BAAG;EACd,IAAM,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC;CACzB,CAAA;;;;;AAKH,iBAAE,eAAe,+BAAG;EAClB,IAAM,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;CAC7B,CAAA;;;;;AAKH,iBAAE,gBAAgB,gCAAG;EACnB,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;CAC9B,CAAA;;;;;AAKH,iBAAE,iBAAiB,iCAAG;EACpB,IAAM,CAAC,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC;CAC/B,CAAA;;;;;;;;AAQH,iBAAE,cAAc,4BAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE;EAChC,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC;EAChC,IAAM,CAAC,KAAK,CAAC,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;EAClE,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,GAAG,CAAC;EAC/D,IAAM,CAAC,KAAK,CAAC,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;CACjE,CAAA;;;;;;;;AAQH,iBAAE,mBAAmB,iCAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE;EACrC,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;EAC/B,IAAM,CAAC,KAAK,CAAC,gBAAgB,GAAG,IAAI,CAAC;EACrC,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,GAAG,CAAC;EACnC,IAAM,CAAC,KAAK,CAAC,gBAAgB,GAAG,IAAI,CAAC;CACpC,CAAA;;;;;;;;AAQH,iBAAE,kBAAkB,gCAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE;EACpC,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;EAC/B,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;EACpC,IAAM,CAAC,KAAK,CAAC,cAAc,GAAG,GAAG,CAAC;EAClC,IAAM,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;CACnC,CAAA;;;;;;;;;AASH,iBAAE,YAAY,0BAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE;EAClD,IAAM,CAAC,KAAK,CAAC,kBAAkB,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,GAAG,MAAM,CAAC;EACxE,IAAM,CAAC,KAAK,CAAC,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,GAAG,OAAO,CAAC;EAC3E,IAAM,CAAC,KAAK,CAAC,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,GAAG,OAAO,CAAC;EAC3E,IAAM,CAAC,KAAK,CAAC,qBAAqB,GAAG,IAAI,CAAC,KAAK,CAAC,oBAAoB,GAAG,SAAS,CAAC;CAChF,CAAA;;;;;;;;;AASH,iBAAE,iBAAiB,+BAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE;EACvD,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;EAC/B,IAAM,CAAC,KAAK,CAAC,kBAAkB,GAAG,MAAM,CAAC;EACzC,IAAM,CAAC,KAAK,CAAC,mBAAmB,GAAG,OAAO,CAAC;EAC3C,IAAM,CAAC,KAAK,CAAC,mBAAmB,GAAG,OAAO,CAAC;EAC3C,IAAM,CAAC,KAAK,CAAC,qBAAqB,GAAG,SAAS,CAAC;CAC9C,CAAA;;;;;;;;;AASH,iBAAE,gBAAgB,8BAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE;EACtD,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;EAC/B,IAAM,CAAC,KAAK,CAAC,iBAAiB,GAAG,MAAM,CAAC;EACxC,IAAM,CAAC,KAAK,CAAC,kBAAkB,GAAG,OAAO,CAAC;EAC1C,IAAM,CAAC,KAAK,CAAC,kBAAkB,GAAG,OAAO,CAAC;EAC1C,IAAM,CAAC,KAAK,CAAC,oBAAoB,GAAG,SAAS,CAAC;CAC7C,CAAA;;;;;;AAMH,iBAAE,YAAY,0BAAC,SAAS,EAAE;EACxB,IAAM,CAAC,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;CAClC,CAAA;;;;;;AAMH,iBAAE,eAAe,6BAAC,IAAI,EAAE;EACtB,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;CAC9B,CAAA;;;;;;;;;AASH,iBAAE,aAAa,2BAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EAC1B,IAAM,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,KAAK,EAAE,GAAG,CAAC,CAAC,GAAG,GAAG,KAAK,EAAE,GAAG,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC;CAC9F,CAAA;;;;;;;AAOH,iBAAE,YAAY,0BAAC,GAAG,EAAE,GAAG,EAAE;EACvB,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;EAC9B,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;EAC5B,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;CAC3B,CAAA;;;;;;;;;AASH,iBAAE,eAAe,6BAAC,GAAG,EAAE,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE;EAC9C,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;EAC7B,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;EAC5B,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;EAC5B,IAAM,CAAC,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAC;EACtC,IAAM,CAAC,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAC;CACrC,CAAA;;;;;;AAMH,iBAAE,UAAU,wBAAC,EAAE,EAAE;EACf,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;EAC9B,IAAM,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;CACzB,CAAA;;;;;;;AAOH,iBAAE,aAAa,2BAAC,EAAE,EAAE,OAAO,EAAE;EAC3B,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;EAC7B,IAAM,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;EAC1B,IAAM,CAAC,KAAK,CAAC,YAAY,GAAG,OAAO,CAAC;CACnC,CAAA;;;;;;AAMH,iBAAE,WAAW,yBAAC,IAAI,EAAE;EAClB,IAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;CAC5B,CAAA;;;;;;;;AAQH,iBAAE,eAAe,6BAAC,MAAM,EAAE,MAAM,EAAE,KAAS,EAAE;iCAAN,GAAG,CAAC;;EACzC,IAAM,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;EAC5C,IAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;EACjD,IAAM,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,EAAE;IACnC,IAAM,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;GAC/B;CACF,CAAA;;;;;;AAMH,iBAAE,cAAc,4BAAC,MAAM,EAAE;EACvB,IAAM,CAAC,KAAK,CAAC,WAAW,GAAG,MAAM,CAAC;CACjC,CAAA;;;;;;AAMH,iBAAE,UAAU,wBAAC,OAAO,EAAE;EACpB,IAAM,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;CAC9B,CAAA;;;;;;;;AAQH,iBAAE,UAAU,wBAAC,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE;EAChC,IAAM,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;IACxC,OAAS,CAAC,IAAI,EAAC,sBAAqB,GAAE,IAAI,eAAW,GAAE,IAAI,2BAAuB,IAAE,IAAI,CAAC,KAAK,CAAC,eAAe,CAAA,EAAG,CAAC;IAClH,OAAS;GACR;;EAEH,IAAM,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;EAC1C,IAAM,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;CAC7B,CAAA;;;;;;;;AAQH,iBAAE,eAAe,6BAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE;;;EACvC,IAAM,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC;EAC5B,IAAM,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;IACvC,OAAS,CAAC,IAAI,EAAC,cAAa,GAAE,GAAG,mBAAe,GAAE,IAAI,2BAAuB,IAAE,IAAI,CAAC,KAAK,CAAC,eAAe,CAAA,EAAG,CAAC;IAC7G,OAAS;GACR;EACH,KAAOD,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC,EAAE;IAC9B,IAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACtB,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;GAC7C;EACH,IAAM,CAAC,UAAU,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;CAC9B,CAAA;;;;;;;AAOH,iBAAE,UAAU,wBAAC,IAAI,EAAE,KAAK,EAAE;EACxB,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;EACrC,IAAM,CAAC,OAAO,EAAE;IACd,OAAS,GAAG;MACV,KAAO,EAAE,IAAI;MACb,KAAO,EAAE,KAAK;KACb,CAAC;GACH,MAAM;IACP,OAAS,CAAC,KAAK,GAAG,IAAI,CAAC;IACvB,OAAS,CAAC,KAAK,GAAG,KAAK,CAAC;GACvB;EACH,IAAM,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;CAChC,CAAA;;;;;;AAMH,iBAAE,gBAAgB,8BAAC,IAAI,EAAE;EACvB,IAAM,CAAC,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC;CACjC,CAAA;;;;;;;AAOH,iBAAE,IAAI,kBAAC,IAAI,EAAE,KAAK,EAAE;;;EAClB,IAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;EACtB,IAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC;EAC1B,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;;;EAGxB,kBAAoB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGpC,kBAAoB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGpC,oBAAsB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGtC,eAAiB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGjC,oBAAsB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGtC,IAAM,GAAG,CAAC,WAAW,KAAK,IAAI,CAAC,WAAW,EAAE;IAC1C,EAAI,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;GAC1F;;;EAGH,IAAM,YAAY,GAAG,KAAK,CAAC;EAC3B,IAAM,GAAG,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE;IAClC,IAAM,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;MAC1B,EAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;KACnC,MAAM;MACP,OAAS,CAAC,IAAI,CAAC,4CAA4C,CAAC,CAAC;KAC5D;IACH,YAAc,GAAG,IAAI,CAAC;GACrB;;;EAGH,eAAiB,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;;EAGjC,KAAOA,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;IACxD,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;IAC9C,IAAM,OAAO,GAAGI,MAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;IACjD,IAAM,CAAC,OAAO,EAAE;;MAEd,SAAW;KACV;;IAEH,IAAM,CAAC,YAAY,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;MACrC,SAAW;KACV;;IAEH,OAAS,CAAC,KAAK,GAAG,KAAK,CAAC;;;;IAIxB,IAAM,UAAU,GAAG,CAAC,WAAW,CAAC,IAAI,KAAK,SAAS,IAAI,mBAAmB,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,wBAAwB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;IACzI,IAAM,CAAC,UAAU,EAAE;MACjB,OAAS,CAAC,IAAI,EAAC,2CAA0C,IAAE,WAAW,CAAC,IAAI,CAAA,EAAG,CAAC;MAC/E,SAAW;KACV;;IAEH,UAAY,CAAC,EAAE,EAAE,WAAW,CAAC,QAAQ,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;GACrD;;;EAGH,IAAM,IAAI,CAAC,WAAW,EAAE;IACtB,EAAI,CAAC,YAAY;MACf,IAAM,CAAC,KAAK,CAAC,aAAa;MAC1B,KAAO;MACP,IAAM,CAAC,WAAW,CAAC,OAAO;MAC1B,IAAM,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM;KAC/B,CAAC;GACH,MAAM;IACP,EAAI,CAAC,UAAU;MACb,IAAM,CAAC,KAAK,CAAC,aAAa;MAC1B,IAAM;MACN,KAAO;KACN,CAAC;GACH;;;;;;;;;EASH,IAAM,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,CAAC;;;EAG7B,GAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;EAChB,IAAM,CAAC,KAAK,EAAE,CAAC;CACd,CAAA;;AC7rCHJ,IAAI,GAAG,GAAG;;EAER,cAAA,YAAY;EACZ,aAAA,WAAW;EACX,cAAA,YAAY;EACZ,SAAA,OAAO;EACP,SAAA,OAAO;EACP,WAAA,SAAS;EACT,aAAA,WAAW;EACX,cAAA,YAAY;EACZ,aAAA,WAAW;EACX,QAAA,MAAM;;;EAGN,eAAA,aAAa;EACb,UAAA,QAAQ;EACR,cAAA,YAAY;CACb,CAAC;AACF,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,AAE1B;;;;"}